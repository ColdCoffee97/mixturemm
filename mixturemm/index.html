
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://FAIRChemistry.github.io/mixturemm/mixturemm/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.6">
    
    
      
        <title>mixturemm module - mixturemm</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4a0965b7.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto Slab";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mixturemm" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="mixturemm" class="md-header__button md-logo" aria-label="mixturemm" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M256 224c-17.6 0-32.9 14.4-32.9 32s15.3 32 32.9 32c17.63 0 32-14.38 32-32s-14.4-32-32-32zm214.2-96c-10.88-19.5-40.51-50.75-116.3-41.88C332.4 34.88 299.6 0 256 0s-76.4 34.88-97.9 86.12C82.34 77.38 52.71 108.5 41.83 128c-16.38 29.38-14.91 73.12 25.23 128-40.13 54.88-41.61 98.63-25.23 128 29.13 52.38 101.6 43.63 116.3 41.88C179.6 477.1 212.4 512 256 512s76.39-34.88 97.9-86.13C368.5 427.6 441 436.4 470.2 384c16.38-29.38 14.91-73.13-25.23-128 40.13-54.9 41.53-98.6 25.23-128zM95.34 352c-4.001-7.25-.125-24.75 15-48.25 6.876 6.5 14.13 12.87 21.88 19.12 1.625 13.75 4.001 27.13 6.751 40.13-24.671.9-39.881-4.4-43.631-11zm36.86-162.9c-7.7 6.3-15 12.7-21.9 19.1-15.08-23.4-18.96-41-14.96-48.2 3.376-6.125 16.38-11.5 37.88-11.5 1.75 0 3.876.375 5.751.375C136.1 162.2 133.8 175.6 132.2 189.1zM256 64c9.502 0 22.25 13.5 33.88 37.25C278.6 105 267.4 109.3 256 114.1c-11.4-4.8-22.6-9.1-33.9-12.9C233.7 77.5 246.5 64 256 64zm0 384c-9.502 0-22.25-13.5-33.88-37.25C233.4 407 244.6 402.7 256 397.9a437.89 437.89 0 0 0 33.88 12.89C278.3 434.5 265.5 448 256 448zm0-112c-44.13 0-80.02-35.88-80.02-80s35.92-80 80.02-80 80.02 35.88 80.02 80-35.92 80-80.02 80zm160.7 16c-3.626 6.625-19 11.88-43.63 11 2.751-12.1 5.126-26.38 6.751-40.13 7.752-6.25 15-12.63 21.88-19.12C416.8 327.2 420.7 344.8 416.7 352zm-15-143.8a368.765 368.765 0 0 0-21.88-19.12 442.887 442.887 0 0 0-6.751-40.25c1.875 0 4.001-.375 5.751-.375 21.5 0 34.51 5.375 37.88 11.5 4 7.245.1 24.845-15 48.245z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mixturemm
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              mixturemm module
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/FAIRChemistry/mixturemm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../installation/" class="md-tabs__link">
      Installation
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../usage/" class="md-tabs__link">
      Usage
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../scientific/" class="md-tabs__link">
      Scientific background
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://github.com/FAIRChemistry/mixturemm/issues" class="md-tabs__link">
      Report Issues
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="./" class="md-tabs__link md-tabs__link--active">
        API Reference
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="mixturemm" class="md-nav__button md-logo" aria-label="mixturemm" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M256 224c-17.6 0-32.9 14.4-32.9 32s15.3 32 32.9 32c17.63 0 32-14.38 32-32s-14.4-32-32-32zm214.2-96c-10.88-19.5-40.51-50.75-116.3-41.88C332.4 34.88 299.6 0 256 0s-76.4 34.88-97.9 86.12C82.34 77.38 52.71 108.5 41.83 128c-16.38 29.38-14.91 73.12 25.23 128-40.13 54.88-41.61 98.63-25.23 128 29.13 52.38 101.6 43.63 116.3 41.88C179.6 477.1 212.4 512 256 512s76.39-34.88 97.9-86.13C368.5 427.6 441 436.4 470.2 384c16.38-29.38 14.91-73.13-25.23-128 40.13-54.9 41.53-98.6 25.23-128zM95.34 352c-4.001-7.25-.125-24.75 15-48.25 6.876 6.5 14.13 12.87 21.88 19.12 1.625 13.75 4.001 27.13 6.751 40.13-24.671.9-39.881-4.4-43.631-11zm36.86-162.9c-7.7 6.3-15 12.7-21.9 19.1-15.08-23.4-18.96-41-14.96-48.2 3.376-6.125 16.38-11.5 37.88-11.5 1.75 0 3.876.375 5.751.375C136.1 162.2 133.8 175.6 132.2 189.1zM256 64c9.502 0 22.25 13.5 33.88 37.25C278.6 105 267.4 109.3 256 114.1c-11.4-4.8-22.6-9.1-33.9-12.9C233.7 77.5 246.5 64 256 64zm0 384c-9.502 0-22.25-13.5-33.88-37.25C233.4 407 244.6 402.7 256 397.9a437.89 437.89 0 0 0 33.88 12.89C278.3 434.5 265.5 448 256 448zm0-112c-44.13 0-80.02-35.88-80.02-80s35.92-80 80.02-80 80.02 35.88 80.02 80-35.92 80-80.02 80zm160.7 16c-3.626 6.625-19 11.88-43.63 11 2.751-12.1 5.126-26.38 6.751-40.13 7.752-6.25 15-12.63 21.88-19.12C416.8 327.2 420.7 344.8 416.7 352zm-15-143.8a368.765 368.765 0 0 0-21.88-19.12 442.887 442.887 0 0 0-6.751-40.25c1.875 0 4.001-.375 5.751-.375 21.5 0 34.51 5.375 37.88 11.5 4 7.245.1 24.845-15 48.245z"/></svg>

    </a>
    mixturemm
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/FAIRChemistry/mixturemm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        Usage
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../scientific/" class="md-nav__link">
        Scientific background
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/FAIRChemistry/mixturemm/issues" class="md-nav__link">
        Report Issues
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          mixturemm module
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        mixturemm module
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mixturemm.mixturemm" class="md-nav__link">
    mixturemm.mixturemm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Forcefield" class="md-nav__link">
    Forcefield
  </a>
  
    <nav class="md-nav" aria-label="Forcefield">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Forcefield.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Mixture" class="md-nav__link">
    Mixture
  </a>
  
    <nav class="md-nav" aria-label="Mixture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Mixture.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Molecule" class="md-nav__link">
    Molecule
  </a>
  
    <nav class="md-nav" aria-label="Molecule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Molecule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project" class="md-nav__link">
    Project
  </a>
  
    <nav class="md-nav" aria-label="Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.add_forcefield" class="md-nav__link">
    add_forcefield()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.add_mixture" class="md-nav__link">
    add_mixture()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.add_molecule" class="md-nav__link">
    add_molecule()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.adjust_to_correct_density" class="md-nav__link">
    adjust_to_correct_density()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_description" class="md-nav__link">
    create_description()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_hpc_submission_adjust_to_correct_density" class="md-nav__link">
    create_hpc_submission_adjust_to_correct_density()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_hpc_submission_analyze_density" class="md-nav__link">
    create_hpc_submission_analyze_density()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_hpc_submission_analyze_hbonds" class="md-nav__link">
    create_hpc_submission_analyze_hbonds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_hpc_submission_analyze_msd" class="md-nav__link">
    create_hpc_submission_analyze_msd()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_hpc_submission_simulate" class="md-nav__link">
    create_hpc_submission_simulate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_replicas" class="md-nav__link">
    create_replicas()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_simulationboxes" class="md-nav__link">
    create_simulationboxes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_systems" class="md-nav__link">
    create_systems()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.hpc_extend_replica_folders" class="md-nav__link">
    hpc_extend_replica_folders()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.hpc_job_checker" class="md-nav__link">
    hpc_job_checker()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.overcharge_replicas" class="md-nav__link">
    overcharge_replicas()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.remove_done_jobs_from_replicas" class="md-nav__link">
    remove_done_jobs_from_replicas()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.remove_done_jobs_from_systems" class="md-nav__link">
    remove_done_jobs_from_systems()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.simulate" class="md-nav__link">
    simulate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.transfer_project" class="md-nav__link">
    transfer_project()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../background/" class="md-nav__link">
        background modue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tools/" class="md-nav__link">
        tools module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        utils module
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mixturemm.mixturemm" class="md-nav__link">
    mixturemm.mixturemm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Forcefield" class="md-nav__link">
    Forcefield
  </a>
  
    <nav class="md-nav" aria-label="Forcefield">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Forcefield.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Mixture" class="md-nav__link">
    Mixture
  </a>
  
    <nav class="md-nav" aria-label="Mixture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Mixture.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Molecule" class="md-nav__link">
    Molecule
  </a>
  
    <nav class="md-nav" aria-label="Molecule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Molecule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project" class="md-nav__link">
    Project
  </a>
  
    <nav class="md-nav" aria-label="Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.add_forcefield" class="md-nav__link">
    add_forcefield()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.add_mixture" class="md-nav__link">
    add_mixture()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.add_molecule" class="md-nav__link">
    add_molecule()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.adjust_to_correct_density" class="md-nav__link">
    adjust_to_correct_density()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_description" class="md-nav__link">
    create_description()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_hpc_submission_adjust_to_correct_density" class="md-nav__link">
    create_hpc_submission_adjust_to_correct_density()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_hpc_submission_analyze_density" class="md-nav__link">
    create_hpc_submission_analyze_density()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_hpc_submission_analyze_hbonds" class="md-nav__link">
    create_hpc_submission_analyze_hbonds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_hpc_submission_analyze_msd" class="md-nav__link">
    create_hpc_submission_analyze_msd()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_hpc_submission_simulate" class="md-nav__link">
    create_hpc_submission_simulate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_replicas" class="md-nav__link">
    create_replicas()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_simulationboxes" class="md-nav__link">
    create_simulationboxes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.create_systems" class="md-nav__link">
    create_systems()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.hpc_extend_replica_folders" class="md-nav__link">
    hpc_extend_replica_folders()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.hpc_job_checker" class="md-nav__link">
    hpc_job_checker()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.overcharge_replicas" class="md-nav__link">
    overcharge_replicas()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.remove_done_jobs_from_replicas" class="md-nav__link">
    remove_done_jobs_from_replicas()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.remove_done_jobs_from_systems" class="md-nav__link">
    remove_done_jobs_from_systems()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.simulate" class="md-nav__link">
    simulate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixturemm.mixturemm.Project.transfer_project" class="md-nav__link">
    transfer_project()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              



                
  <a href="https://github.com/FAIRChemistry/mixturemm/edit/master/docs/mixturemm.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="mixturemm">mixturemm<a class="headerlink" href="#mixturemm" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="mixturemm.mixturemm"></a>
  <div class="doc doc-contents first">
  
      <p>Main module.</p>
<p>MIT License</p>
<p>Copyright (c) 2021, Benjamin Schmitz</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="mixturemm.mixturemm.Forcefield" class="doc doc-heading">
        <code>Forcefield</code>


<a href="#mixturemm.mixturemm.Forcefield" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">



        <details class="quote">
          <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Forcefield</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
    <span class="n">workdir</span><span class="p">,</span>
    <span class="n">path_to_XML</span><span class="p">,</span> 
    <span class="n">ff_name</span><span class="p">,</span> 
    <span class="n">built_in</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">elements</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Contains information on the force field.</span>

<span class="sd">        Args:</span>
<span class="sd">            workdir (str): The path at which the project is stored.</span>
<span class="sd">            path_to_XML (str): The path to the force field XML file.</span>
<span class="sd">            ff_name (str): The name under which the force field should be stored.</span>
<span class="sd">            built_in (bool, optional): Decides whether the fore field is part of openMM or from an external source. If true, declares that a built in forcefield of openmm will be used. Defaults to True.</span>
<span class="sd">            elements (dict, optional): OpenMM uses Elements to match molecules to the force field. If atomtypes in the force field are unknown to OpenMM, they are registered by giving their name and mass in the form {&#39;name&#39; : mass}. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">forcedir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/forcefield&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff_name</span> <span class="o">=</span> <span class="n">ff_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">built_in</span> <span class="o">=</span> <span class="n">built_in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="n">elements</span>
        <span class="k">if</span> <span class="n">built_in</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">path_to_XML</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forcedir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">ff_name</span><span class="si">}</span><span class="s1">.xml&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forcedir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">ff_name</span><span class="si">}</span><span class="s1">.xml&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path_to_XML</span>
        <span class="k">if</span> <span class="n">elements</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">mass</span> <span class="ow">in</span> <span class="n">elements</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="o">*</span><span class="n">amu</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Forcefield.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">workdir</span><span class="p">,</span> <span class="n">path_to_XML</span><span class="p">,</span> <span class="n">ff_name</span><span class="p">,</span> <span class="n">built_in</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Forcefield.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Contains information on the force field.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>workdir</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path at which the project is stored.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>path_to_XML</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the force field XML file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ff_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name under which the force field should be stored.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>built_in</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Decides whether the fore field is part of openMM or from an external source. If true, declares that a built in forcefield of openmm will be used. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>elements</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>OpenMM uses Elements to match molecules to the force field. If atomtypes in the force field are unknown to OpenMM, they are registered by giving their name and mass in the form {'name' : mass}. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
<span class="n">workdir</span><span class="p">,</span>
<span class="n">path_to_XML</span><span class="p">,</span> 
<span class="n">ff_name</span><span class="p">,</span> 
<span class="n">built_in</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
<span class="n">elements</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Contains information on the force field.</span>

<span class="sd">    Args:</span>
<span class="sd">        workdir (str): The path at which the project is stored.</span>
<span class="sd">        path_to_XML (str): The path to the force field XML file.</span>
<span class="sd">        ff_name (str): The name under which the force field should be stored.</span>
<span class="sd">        built_in (bool, optional): Decides whether the fore field is part of openMM or from an external source. If true, declares that a built in forcefield of openmm will be used. Defaults to True.</span>
<span class="sd">        elements (dict, optional): OpenMM uses Elements to match molecules to the force field. If atomtypes in the force field are unknown to OpenMM, they are registered by giving their name and mass in the form {&#39;name&#39; : mass}. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">forcedir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/forcefield&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ff_name</span> <span class="o">=</span> <span class="n">ff_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">built_in</span> <span class="o">=</span> <span class="n">built_in</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="n">elements</span>
    <span class="k">if</span> <span class="n">built_in</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">path_to_XML</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forcedir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">ff_name</span><span class="si">}</span><span class="s1">.xml&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forcedir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">ff_name</span><span class="si">}</span><span class="s1">.xml&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path_to_XML</span>
    <span class="k">if</span> <span class="n">elements</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">mass</span> <span class="ow">in</span> <span class="n">elements</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">_</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="o">*</span><span class="n">amu</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mixturemm.mixturemm.Mixture" class="doc doc-heading">
        <code>Mixture</code>


<a href="#mixturemm.mixturemm.Mixture" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">



        <details class="quote">
          <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Mixture</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">mixture_dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Contains information on the mixture that is simulated.</span>

<span class="sd">        Args:</span>
<span class="sd">            mixture_dict (dict): Dictionary with molecule names and their corresponding mole fraction in the mixture.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mixture_dict</span> <span class="o">=</span> <span class="n">mixture_dict</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Mixture.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">mixture_dict</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Mixture.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Contains information on the mixture that is simulated.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mixture_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Dictionary with molecule names and their corresponding mole fraction in the mixture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<span class="n">mixture_dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Contains information on the mixture that is simulated.</span>

<span class="sd">    Args:</span>
<span class="sd">        mixture_dict (dict): Dictionary with molecule names and their corresponding mole fraction in the mixture.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">mixture_dict</span> <span class="o">=</span> <span class="n">mixture_dict</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mixturemm.mixturemm.Molecule" class="doc doc-heading">
        <code>Molecule</code>


<a href="#mixturemm.mixturemm.Molecule" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">



        <details class="quote">
          <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Molecule</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">workdir</span><span class="p">,</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">number_of_atoms</span><span class="p">,</span>
    <span class="n">path_to_pdb</span><span class="p">,</span>
    <span class="n">abbreviation</span><span class="p">,</span>
    <span class="n">smiles</span><span class="p">,</span>
    <span class="n">inchi</span><span class="p">,</span>
    <span class="n">molar_mass</span><span class="p">,</span>
    <span class="n">use_as_water</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Contains information on the molecule that is used for packing with packmol and to identify it.</span>

<span class="sd">        Args:</span>
<span class="sd">            workdir (str): The path at which the project is stored.</span>
<span class="sd">            name (str): Name of the molecule.</span>
<span class="sd">            number_of_atoms (int): The number of atoms that the molecule consists of.</span>
<span class="sd">            path_to_pdb (str): The path to the molecule PDB file.</span>
<span class="sd">            abbreviation (str): The abbreviation of the molecule that is used inside the PDB file.</span>
<span class="sd">            smiles (str): The SMILES code of the molecule.</span>
<span class="sd">            inchi (str): The InChI code of the molecule.</span>
<span class="sd">            molar_mass (str): The molar mass of the molecule.</span>
<span class="sd">            use_as_water (bool, optional): Decides whether the molecule is used as water or not. If used as water, the water molar fraction is applied to it while packing boxes. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">moldir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/molecules&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_atoms</span> <span class="o">=</span> <span class="n">number_of_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abbreviation</span> <span class="o">=</span> <span class="n">abbreviation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smiles</span> <span class="o">=</span> <span class="n">smiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inchi</span> <span class="o">=</span> <span class="n">inchi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span> <span class="o">=</span> <span class="n">molar_mass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_as_water</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">use_as_water</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_as_water</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">path_to_pdb</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">moldir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.pdb&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">moldir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.pdb&#39;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Molecule.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">workdir</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">number_of_atoms</span><span class="p">,</span> <span class="n">path_to_pdb</span><span class="p">,</span> <span class="n">abbreviation</span><span class="p">,</span> <span class="n">smiles</span><span class="p">,</span> <span class="n">inchi</span><span class="p">,</span> <span class="n">molar_mass</span><span class="p">,</span> <span class="n">use_as_water</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Molecule.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Contains information on the molecule that is used for packing with packmol and to identify it.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>workdir</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path at which the project is stored.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Name of the molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>number_of_atoms</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of atoms that the molecule consists of.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>path_to_pdb</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the molecule PDB file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>abbreviation</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The abbreviation of the molecule that is used inside the PDB file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>smiles</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The SMILES code of the molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inchi</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The InChI code of the molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>molar_mass</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The molar mass of the molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>use_as_water</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Decides whether the molecule is used as water or not. If used as water, the water molar fraction is applied to it while packing boxes. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<span class="n">workdir</span><span class="p">,</span>
<span class="n">name</span><span class="p">,</span>
<span class="n">number_of_atoms</span><span class="p">,</span>
<span class="n">path_to_pdb</span><span class="p">,</span>
<span class="n">abbreviation</span><span class="p">,</span>
<span class="n">smiles</span><span class="p">,</span>
<span class="n">inchi</span><span class="p">,</span>
<span class="n">molar_mass</span><span class="p">,</span>
<span class="n">use_as_water</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Contains information on the molecule that is used for packing with packmol and to identify it.</span>

<span class="sd">    Args:</span>
<span class="sd">        workdir (str): The path at which the project is stored.</span>
<span class="sd">        name (str): Name of the molecule.</span>
<span class="sd">        number_of_atoms (int): The number of atoms that the molecule consists of.</span>
<span class="sd">        path_to_pdb (str): The path to the molecule PDB file.</span>
<span class="sd">        abbreviation (str): The abbreviation of the molecule that is used inside the PDB file.</span>
<span class="sd">        smiles (str): The SMILES code of the molecule.</span>
<span class="sd">        inchi (str): The InChI code of the molecule.</span>
<span class="sd">        molar_mass (str): The molar mass of the molecule.</span>
<span class="sd">        use_as_water (bool, optional): Decides whether the molecule is used as water or not. If used as water, the water molar fraction is applied to it while packing boxes. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">moldir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/molecules&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_atoms</span> <span class="o">=</span> <span class="n">number_of_atoms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">abbreviation</span> <span class="o">=</span> <span class="n">abbreviation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">smiles</span> <span class="o">=</span> <span class="n">smiles</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">inchi</span> <span class="o">=</span> <span class="n">inchi</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span> <span class="o">=</span> <span class="n">molar_mass</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_as_water</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">use_as_water</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_as_water</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">path_to_pdb</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">moldir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.pdb&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">moldir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.pdb&#39;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mixturemm.mixturemm.Project" class="doc doc-heading">
        <code>Project</code>


<a href="#mixturemm.mixturemm.Project" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">



        <details class="quote">
          <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Project</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">workdir</span><span class="p">,</span>
    <span class="n">simulation_platform</span><span class="o">=</span><span class="s1">&#39;CUDA&#39;</span><span class="p">,</span>
    <span class="n">simulation_properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;DeviceIndex&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="s1">&#39;double&#39;</span><span class="p">},</span>
    <span class="n">total_number_molecules</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">],</span>
    <span class="n">init_box_side_length</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span>
    <span class="n">chi_water_s</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">temperature_s</span><span class="o">=</span><span class="p">[</span><span class="mf">298.15</span><span class="p">],</span>
    <span class="n">npt_equilibration_pressure_s</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">npt_equilibration_pressure_coupling_frequency</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">npt_equilibration_temperature_coupling_frequency</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">npt_equilibration_timestep_fs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">npt_equilibration_duration_ns</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">reporting_frequency_state_npt_equilibration</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="n">nvt_equilibration_temperature_coupling_frequency</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">nvt_equilibration_timestep_fs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">nvt_equilibration_duration_ns</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">reporting_frequency_state_nvt_equilibration</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
    <span class="n">nve_production_timestep_fs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">nve_production_duration_ns</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">reporting_frequency_coordinates_unwrapped</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
    <span class="n">reporting_frequency_coordinates_wrapped</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span>
    <span class="n">reporting_frequency_state_nve_production</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span>
    <span class="n">replica_count</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">pme_error_tolerance</span><span class="o">=</span><span class="mf">0.000001</span><span class="p">,</span>
    <span class="n">constraint_tolerance</span><span class="o">=</span><span class="mf">0.0000001</span><span class="p">,</span>
    <span class="n">cutoff_distance_nm</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span>
    <span class="n">cutoff_switch_distance_nm</span><span class="o">=</span><span class="mf">1.0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The project holds all parameters and functions to do a complete systematic simulation of different systems in openmm.</span>

<span class="sd">        Args:</span>
<span class="sd">            workdir (str): The path at which the project should be stored.</span>
<span class="sd">            simulation_platform (str, optional): The platform the simulation should run on. Defaults to &#39;CUDA&#39;.</span>
<span class="sd">            simulation_properties (dict, optional): The platform properties for the simulation. Defaults to {&#39;DeviceIndex&#39;: &#39;0&#39;, &#39;Precision&#39;: &#39;double&#39;}.</span>
<span class="sd">            total_number_molecules (list, optional): A list with the number of molecules that should be placed in the simulation box. Defaults to [1000].</span>
<span class="sd">            init_box_side_length (list, optional): The initial box side lengths that should be used by packmol. Defaults to [30].</span>
<span class="sd">            chi_water_s (list, optional): A list with all different molar fractions of water that should be simulated. Defaults to [0,0.5,1].</span>
<span class="sd">            temperature_s (list, optional): A list with all different temperatures in kelvin at which the boxes should be simulated. Defaults to [298.15].</span>
<span class="sd">            npt_equilibration_pressure_s (list, optional): A list with all pressures in bar at which the boxes should be simulated. Defaults to [1].</span>
<span class="sd">            npt_equilibration_pressure_coupling_frequency (int, optional): The pressure coupling frequency at which the Monte Carlo barostat should interact with the system and attempt a Monte Carlo move to adjust the volume during the NpT equilibration in simulation steps. Defaults to 25.</span>
<span class="sd">            npt_equilibration_temperature_coupling_frequency (float, optional): The friction coefficient of the Langevin thermostat during the NpT equilibration in inverse picoseconds. Defaults to 0.1.</span>
<span class="sd">            npt_equilibration_timestep_fs (int, optional): The integration time step during the NpT equilibration in femtoseconds. Defaults to 2.</span>
<span class="sd">            npt_equilibration_duration_ns (int, optional): The duration of the NpT equilibration in nanoseconds. Defaults to 10.</span>
<span class="sd">            reporting_frequency_state_npt_equilibration (int, optional): The reporting frequency of the openMM StateDataReporter in simulation steps during the NpT equilibration. Defaults to 500.</span>
<span class="sd">            nvt_equilibration_temperature_coupling_frequency (float, optional): The friction coefficient of the Langevin thermostat during the NVT equilibration in inverse picoseconds. Defaults to 0.1.</span>
<span class="sd">            nvt_equilibration_timestep_fs (int, optional): The integration time step during the NVT equilibration in femtoseconds. Defaults to 2.</span>
<span class="sd">            nvt_equilibration_duration_ns (int, optional): The duration of the NVT equilibration in nanoseconds. Defaults to 20.</span>
<span class="sd">            reporting_frequency_state_nvt_equilibration (int, optional): The reporting frequency of the openMM StateDataReporter in simulation steps during the NVT equilibration. Defaults to 2000.</span>
<span class="sd">            nve_production_timestep_fs (int, optional): The integration time step during the NVE production in femtoseconds. Defaults to 1.</span>
<span class="sd">            nve_production_duration_ns (int, optional): The duration of the NVE production in nanoseconds. Defaults to 20.</span>
<span class="sd">            reporting_frequency_coordinates_unwrapped (int, optional): The reporting frequency of the trajectory with unwrapped coordinates in simulation steps during the NVE production. Defaults to 2000.</span>
<span class="sd">            reporting_frequency_coordinates_wrapped (int, optional): The reporting frequency of the trajectory with wrapped coordinates in simulation steps during the NVE production. Defaults to 4000.</span>
<span class="sd">            reporting_frequency_state_nve_production (int, optional): The reporting frequency of the openMM StateDataReporter in simulation steps during the NVE production. Defaults to 4000.</span>
<span class="sd">            replica_count (int, optional): The number of times the simulation of one system should be replicated. Defaults to 10.</span>
<span class="sd">            pme_error_tolerance (float, optional): Decides how large the grid for PME is together with the cutoff. Defaults to 0.000001.</span>
<span class="sd">            constraint_tolerance (float, optional): The constraint tolerance specifies the distance tolerance within which constraints are maintained, as a fraction of the constrained distance. Defaults to 0.0000001</span>
<span class="sd">            cutoff_distance_nm (float, optional): The cutoff distance for nonbonded interactions in nanometers. Defaults to 1.2.</span>
<span class="sd">            cutoff_switch_distance_nm (float, optional): Starting point of the switching function that makes the energy go smoothly to 0 at the cutoff distance in nanometers. Defaults to 1.0.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">workdir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="n">workdir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moldir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/molecules&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxdir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/boxes&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resdir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/results&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/hpc_submission&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forcedir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/forcefield&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_rawdir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">resdir</span><span class="si">}</span><span class="s1">/raw_data&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_partsdir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">resdir</span><span class="si">}</span><span class="s1">/parts&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecules</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simulation_boxes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecule_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecule_number_of_atoms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecule_abbreviations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mixture_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forcefields</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chi_water_s</span> <span class="o">=</span> <span class="n">chi_water_s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_number_molecules</span> <span class="o">=</span> <span class="n">total_number_molecules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_box_side_length</span> <span class="o">=</span> <span class="n">init_box_side_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">water_name</span> <span class="o">=</span> <span class="s1">&#39;Water&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">water_abbreviation</span> <span class="o">=</span> <span class="s1">&#39;HOH&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replica_number_dict</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simulation_platform</span> <span class="o">=</span> <span class="n">simulation_platform</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simulation_properties</span> <span class="o">=</span> <span class="n">simulation_properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature_s</span> <span class="o">=</span> <span class="n">temperature_s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_pressure_s</span> <span class="o">=</span> <span class="n">npt_equilibration_pressure_s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_pressure_coupling_frequency</span> <span class="o">=</span> <span class="n">npt_equilibration_pressure_coupling_frequency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_temperature_coupling_frequency</span> <span class="o">=</span> <span class="n">npt_equilibration_temperature_coupling_frequency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_timestep_fs</span> <span class="o">=</span> <span class="n">npt_equilibration_timestep_fs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_duration_ns</span> <span class="o">=</span> <span class="n">npt_equilibration_duration_ns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nvt_equilibration_temperature_coupling_frequency</span> <span class="o">=</span> <span class="n">nvt_equilibration_temperature_coupling_frequency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nvt_equilibration_timestep_fs</span> <span class="o">=</span> <span class="n">nvt_equilibration_timestep_fs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nvt_equilibration_duration_ns</span> <span class="o">=</span> <span class="n">nvt_equilibration_duration_ns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nve_production_timestep_fs</span> <span class="o">=</span> <span class="n">nve_production_timestep_fs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nve_production_duration_ns</span> <span class="o">=</span> <span class="n">nve_production_duration_ns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reporting_frequency_coordinates_unwrapped</span> <span class="o">=</span> <span class="n">reporting_frequency_coordinates_unwrapped</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reporting_frequency_coordinates_wrapped</span> <span class="o">=</span> <span class="n">reporting_frequency_coordinates_wrapped</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reporting_frequency_state_npt_equilibration</span> <span class="o">=</span> <span class="n">reporting_frequency_state_npt_equilibration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reporting_frequency_state_nvt_equilibration</span> <span class="o">=</span> <span class="n">reporting_frequency_state_nvt_equilibration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reporting_frequency_state_nve_production</span> <span class="o">=</span> <span class="n">reporting_frequency_state_nve_production</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replica_count</span> <span class="o">=</span> <span class="n">replica_count</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pme_error_tolerance</span> <span class="o">=</span> <span class="n">pme_error_tolerance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constraint_tolerance</span> <span class="o">=</span> <span class="n">constraint_tolerance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff_distance_nm</span> <span class="o">=</span> <span class="n">cutoff_distance_nm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff_switch_distance_nm</span> <span class="o">=</span> <span class="n">cutoff_switch_distance_nm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">half_npt_equilibration_csv_columns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((((</span><span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_duration_ns</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_timestep_fs</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">))</span><span class="o">/</span><span class="n">reporting_frequency_state_npt_equilibration</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_description</span><span class="p">()</span>
        <span class="n">m_utils</span><span class="o">.</span><span class="n">add_chainsubmitter_script</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Creates a .json file with all input arguments of the project and info on all added files.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">json_structure</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">jsonize_project</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">json_structure</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">m_utils</span><span class="o">.</span><span class="n">merge_project_descriptions</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span><span class="p">,</span> <span class="n">json_structure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span>

    <span class="k">def</span> <span class="nf">add_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Molecule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Adds a molecule to the project.</span>

<span class="sd">        Args:</span>
<span class="sd">            Molecule (object): Contains information on the molecule that is used for packing with packmol and to identify it.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">use_as_water</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_name</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_abbreviation</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">abbreviation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">molecules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Molecule</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">molecule_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Molecule</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">molecule_number_of_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">molecule_abbreviations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Molecule</span><span class="o">.</span><span class="n">abbreviation</span><span class="p">)</span>
        <span class="n">json_structure</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">jsonize_molecule</span><span class="p">(</span><span class="n">Molecule</span><span class="p">)</span>
        <span class="n">m_utils</span><span class="o">.</span><span class="n">add_json_entry</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">json_structure</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;molecules&#39;</span><span class="p">,</span> <span class="n">subkey</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Molecule</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_forcefield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Forcefield</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Adds a force field to the project.</span>

<span class="sd">        Args:</span>
<span class="sd">            Forcefield (object): Contains information on the force field.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">forcefields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Forcefield</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Forcefield</span><span class="o">.</span><span class="n">elements</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">Forcefield</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">json_structure</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">jsonize_forcefield</span><span class="p">(</span><span class="n">Forcefield</span><span class="p">)</span>
        <span class="n">m_utils</span><span class="o">.</span><span class="n">add_json_entry</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">json_structure</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;force fields&#39;</span><span class="p">,</span> <span class="n">subkey</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Forcefield</span><span class="o">.</span><span class="n">ff_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_mixture</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Mixture</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Adds a mixture to the project.</span>

<span class="sd">        Args:</span>
<span class="sd">            Mixture (object): Contains information on the mixture that is simulated.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mixture_dict</span> <span class="o">=</span> <span class="n">Mixture</span><span class="o">.</span><span class="n">mixture_dict</span>

    <span class="k">def</span> <span class="nf">create_simulationboxes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Creates and packs the simulation boxes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">LINKER</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>

        <span class="k">for</span> <span class="n">total_number_molecules</span><span class="p">,</span> <span class="n">init_box_side_length</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_number_molecules</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_box_side_length</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">chi_water</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi_water_s</span><span class="p">:</span>
                <span class="n">string_total_number_molecules</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">total_number_molecules</span><span class="p">)</span>
                <span class="n">string_init_box_side_length</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">init_box_side_length</span><span class="p">)</span>
                <span class="n">string_chi_water</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">chi_water</span><span class="p">)</span>
                <span class="n">mixture_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="n">string_total_number_molecules</span><span class="p">,</span> <span class="n">string_init_box_side_length</span><span class="p">,</span> <span class="n">string_chi_water</span><span class="p">)</span>
                <span class="n">mixture_name</span> <span class="o">=</span> <span class="n">LINKER</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mixture_tuple</span><span class="p">)</span>
                <span class="n">simulation_box</span> <span class="o">=</span> <span class="n">Simulationbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total_number_molecules</span><span class="p">,</span> <span class="n">init_box_side_length</span><span class="p">,</span> <span class="n">chi_water</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_name</span><span class="p">,</span> <span class="n">mixture_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">simulation_boxes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulation_box</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_boxes</span><span class="p">:</span>
            <span class="n">x</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
            <span class="n">x</span><span class="o">.</span><span class="n">conect_creator</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">create_systems</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Assigns temperature, pressure and NpT equilibration parameters to the boxes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">parameter_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation_boxes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_pressure_s</span><span class="p">]</span>
        <span class="n">combination_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">parameter_list</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">combination_list</span><span class="p">:</span>
            <span class="n">simulationbox</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="n">combination</span>
            <span class="n">system</span> <span class="o">=</span> <span class="n">Simulationsystem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simulationbox</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">pressure</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_replicas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Creates replicas of the systems and assigns NVT equilibration and NVE production parameters to them.</span>

<span class="sd">        Args:</span>
<span class="sd">            start (int, optional): The number from which on the replica numbering will start. Defaults to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">replica_start</span> <span class="o">=</span> <span class="n">start</span>
        <span class="n">replica_count</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replica_count</span> <span class="o">+</span> <span class="n">start</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replica_number_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">tot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_number_molecules</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">replica_number_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">tot</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">replica_count</span>
        <span class="n">parameter_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">,</span> <span class="n">replica_count</span><span class="p">]</span>
        <span class="n">combination_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">parameter_list</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">combination_list</span><span class="p">:</span>
            <span class="n">system</span><span class="p">,</span> <span class="n">replica_number</span> <span class="o">=</span> <span class="n">combination</span>
            <span class="n">replica</span> <span class="o">=</span> <span class="n">Replica</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">replica_number</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replica</span><span class="p">)</span>

        <span class="n">m_utils</span><span class="o">.</span><span class="n">add_json_entry</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;project&#39;</span><span class="p">,</span> <span class="n">subkey</span><span class="o">=</span><span class="s1">&#39;simulation_parameters&#39;</span><span class="p">,</span> <span class="n">subsubkey</span><span class="o">=</span><span class="s1">&#39;replica_starting_number&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">adjust_to_correct_density</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Runs the NpT equilibration to adjust the system volume and density to the correct value.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">:</span>
            <span class="n">system</span><span class="o">.</span><span class="n">npt_equilibration</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Runs the NVT equilibration and the NVE production.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">:</span>
            <span class="n">replica</span><span class="o">.</span><span class="n">nvt_equilibration</span><span class="p">()</span>
            <span class="n">replica</span><span class="o">.</span><span class="n">nve_production</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">create_hpc_submission_adjust_to_correct_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span>
    <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span>
    <span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span>
    <span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;openmm_new&#39;</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span>
    <span class="n">partition</span><span class="o">=</span><span class="s1">&#39;accelerated&#39;</span><span class="p">,</span>
    <span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span>
    <span class="n">number_of_gpus</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">chunk_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">max_number_of_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;24:00:00&#39;</span><span class="p">,</span>
    <span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">chain_submission_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">dependency_type</span><span class="o">=</span><span class="s1">&#39;afternotok&#39;</span><span class="p">,</span>
    <span class="n">checkpoint_frequency</span><span class="o">=</span><span class="mi">10000</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Creates job submission scripts for bwUniCluster 2.0 or HoreKa containing the NpT equilibration.</span>

<span class="sd">        Args:</span>
<span class="sd">            hpc_workspace (str, optional): The path to the hpc workspace. Defaults to &#39;workspace&#39;.</span>
<span class="sd">            hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">            hpc_scripts_folder (str, optional): The path to the python scripts folder. Defaults to &#39;workspace/HPC&#39;.</span>
<span class="sd">            environment_name (str, optional): The name of the anaconda environment containing the dependencies. Defaults to &#39;openmmfin&#39;.</span>
<span class="sd">            scheduler (str, optional): The queue scheduler. Defaults to &#39;SBATCH&#39;.</span>
<span class="sd">            partition (str, optional): The partition the job should be submitted to. Defaults to &#39;accelerated&#39;.</span>
<span class="sd">            number_of_threads (int, optional): The number of requested threads. Defaults to 152.</span>
<span class="sd">            number_of_gpus (int, optional): The number of GPUs requested on a node. Defaults to 4.</span>
<span class="sd">            chunk_size (int, optional): Number of simulations to submit in a chunk, should correspond to the number of requested GPUs. Defaults to 4.</span>
<span class="sd">            max_number_of_jobs (int, optional): Maximum number of job submissions allowed on the hpc. Defaults to None.</span>
<span class="sd">            max_runtime_hh_mm_ss (str, optional): Maximum runtime for a job. Defaults to &#39;24:00:00&#39;.</span>
<span class="sd">            conda_module (bool): Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</span>
<span class="sd">            chain_submission_number (int, optional): The number of job submissions that should be submitted as a sequential chain job. Defaults to 1.</span>
<span class="sd">            dependency_type (str, optional): Dependency keyword of the SLURM workload manager for chain jobs. Defaults to &#39;afternotok&#39;.</span>
<span class="sd">            checkpoint_frequency (int, optional): The frequency at which checkpoints are saved to restart from once a job continues. Defaults to 10000.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">forcefields_</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^.*?/forcefield&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/forcefield&#39;</span><span class="p">,</span> <span class="n">forcefield</span><span class="p">)</span> <span class="k">for</span> <span class="n">forcefield</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcefields</span><span class="p">]</span>
        <span class="n">forcefields</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">forcefields_</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">max_number_of_jobs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">chunked_simulationsystems</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chunked_simulationsystems</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)][:</span><span class="n">max_number_of_jobs</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunked_simulationsystems</span><span class="p">:</span>
            <span class="n">GPU_INDEX_COUNTER</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">m_utils</span><span class="o">.</span><span class="n">hpc_submission_header</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_adjust_to_correct_density.sh&#39;</span><span class="p">,</span> 
                                          <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_adjust_to_correct_density&#39;</span><span class="p">,</span> 
                                          <span class="n">hpc_workspace</span><span class="p">,</span> 
                                          <span class="n">environment_name</span><span class="p">,</span>
                                          <span class="n">scheduler</span><span class="p">,</span>
                                          <span class="n">partition</span><span class="p">,</span>
                                          <span class="n">number_of_threads</span><span class="p">,</span>
                                          <span class="n">number_of_gpus</span><span class="p">,</span> 
                                          <span class="n">max_runtime_hh_mm_ss</span><span class="p">,</span>
                                          <span class="n">conda_module</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_adjust_to_correct_density.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;DeviceIndex&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Precision&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_properties</span><span class="p">:</span>
                        <span class="n">simulation_properties_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_properties</span>
                        <span class="n">simulation_properties_</span><span class="p">[</span><span class="s1">&#39;DeviceIndex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">GPU_INDEX_COUNTER</span><span class="si">}</span><span class="s1">&#39;</span>
                        <span class="n">simulation_properties</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="n">simulation_properties_</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">simulation_properties_</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;DeviceIndex&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">GPU_INDEX_COUNTER</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="s1">&#39;double&#39;</span><span class="p">}</span>
                        <span class="n">simulation_properties</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="n">simulation_properties_</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_platform</span> <span class="o">==</span> <span class="s1">&#39;CUDA&#39;</span><span class="p">:</span>
                        <span class="n">simulation_platform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_platform</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">simulation_platform</span> <span class="o">=</span> <span class="s1">&#39;CUDA&#39;</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_adjust_to_correct_density.py </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">simulation_properties</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">simulation_platform</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">forcefields</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">pme_error_tolerance</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">cutoff_distance_nm</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">cutoff_switch_distance_nm</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">pressure</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">simulationbox_name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">npt_equilibration_pressure_coupling_frequency</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">npt_equilibration_temperature_coupling_frequency</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">npt_equilibration_timestep_fs</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">npt_equilibration_steps</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">reporting_frequency_state_npt_equilibration</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">constraint_tolerance</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">checkpoint_frequency</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">elements</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">GPU_INDEX_COUNTER</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_adjust_to_correct_density.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">wait</span><span class="se">\n</span><span class="s1">exit 0&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/submit_adjust_to_correct_density.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunked_simulationsystems</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">chain_submission_number</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;bash chainsubmitter.sh </span><span class="si">{</span><span class="n">chain_submission_number</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/shfiles/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_adjust_to_correct_density.sh </span><span class="si">{</span><span class="n">dependency_type</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">partition</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;sbatch chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_adjust_to_correct_density.sh</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_hpc_submission_simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span>
    <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span>
    <span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span>
    <span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;openmm_new&#39;</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span>
    <span class="n">partition</span><span class="o">=</span><span class="s1">&#39;accelerated&#39;</span><span class="p">,</span>
    <span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span>
    <span class="n">number_of_gpus</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">chunk_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">max_number_of_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;24:00:00&#39;</span><span class="p">,</span>
    <span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">chain_submission_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">dependency_type</span><span class="o">=</span><span class="s1">&#39;afternotok&#39;</span><span class="p">,</span>
    <span class="n">checkpoint_frequency</span><span class="o">=</span><span class="mi">10000</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Creates job submission scripts for bwUniCluster 2.0 containing the NVT equilibration and NVE production.</span>

<span class="sd">        Args:</span>
<span class="sd">            hpc_workspace (str, optional): The path to the hpc workspace. Defaults to &#39;workspace&#39;.</span>
<span class="sd">            hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">            hpc_scripts_folder (str, optional): The path to the python scripts folder. Defaults to &#39;workspace/HPC&#39;.</span>
<span class="sd">            environment_name (str, optional): The name of the anaconda environment containing the dependencies. Defaults to &#39;openmmfin&#39;.</span>
<span class="sd">            scheduler (str, optional): The queue scheduler. Defaults to &#39;SBATCH&#39;.</span>
<span class="sd">            partition (str, optional): The partition the job should be submitted to. Defaults to &#39;accelerated&#39;.</span>
<span class="sd">            number_of_threads (int, optional): The number of requested threads. Defaults to 152.</span>
<span class="sd">            number_of_gpus (int, optional): The number of GPUs requested on a node. Defaults to 4.</span>
<span class="sd">            chunk_size (int, optional): Number of simulations to submit in a chunk, should correspond to the number of requested GPUs. Defaults to 4.</span>
<span class="sd">            max_number_of_jobs (int, optional): Maximum number of job submissions allowed on the hpc. Defaults to None.</span>
<span class="sd">            max_runtime_hh_mm_ss (str, optional): Maximum runtime for a job. Defaults to &#39;24:00:00&#39;.</span>
<span class="sd">            conda_module (bool): Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</span>
<span class="sd">            chain_submission_number (int, optional): The number of job submissions that should be submitted as a sequential chain job. Defaults to 1.</span>
<span class="sd">            dependency_type (str, optional): Dependency keyword of the SLURM workload manager for chain jobs. Defaults to &#39;afternotok&#39;.</span>
<span class="sd">            checkpoint_frequency (int, optional): The frequency at which checkpoints are saved to restart from once a job continues. Defaults to 10000.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">forcefields_</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^.*?/forcefield&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/forcefield&#39;</span><span class="p">,</span> <span class="n">forcefield</span><span class="p">)</span> <span class="k">for</span> <span class="n">forcefield</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcefields</span><span class="p">]</span>
        <span class="n">forcefields</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">forcefields_</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">max_number_of_jobs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">chunked_replicas</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chunked_replicas</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)][:</span><span class="n">max_number_of_jobs</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunked_replicas</span><span class="p">:</span>
            <span class="n">GPU_INDEX_COUNTER</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">m_utils</span><span class="o">.</span><span class="n">hpc_submission_header</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_simulate.sh&#39;</span><span class="p">,</span> 
                                          <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_simulate&#39;</span><span class="p">,</span> 
                                          <span class="n">hpc_workspace</span><span class="p">,</span> 
                                          <span class="n">environment_name</span><span class="p">,</span>
                                          <span class="n">scheduler</span><span class="p">,</span>
                                          <span class="n">partition</span><span class="p">,</span>
                                          <span class="n">number_of_threads</span><span class="p">,</span>
                                          <span class="n">number_of_gpus</span><span class="p">,</span>
                                          <span class="n">max_runtime_hh_mm_ss</span><span class="p">,</span>
                                          <span class="n">conda_module</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_simulate.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;DeviceIndex&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Precision&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_properties</span><span class="p">:</span>
                        <span class="n">simulation_properties_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_properties</span>
                        <span class="n">simulation_properties_</span><span class="p">[</span><span class="s1">&#39;DeviceIndex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">GPU_INDEX_COUNTER</span><span class="si">}</span><span class="s1">&#39;</span>
                        <span class="n">simulation_properties</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="n">simulation_properties_</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">simulation_properties_</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;DeviceIndex&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">GPU_INDEX_COUNTER</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="s1">&#39;double&#39;</span><span class="p">}</span>
                        <span class="n">simulation_properties</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="n">simulation_properties_</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_platform</span> <span class="o">==</span> <span class="s1">&#39;CUDA&#39;</span><span class="p">:</span>
                        <span class="n">simulation_platform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_platform</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">simulation_platform</span> <span class="o">=</span> <span class="s1">&#39;CUDA&#39;</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_simulate.py </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">simulation_properties</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">simulation_platform</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">forcefields</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">pme_error_tolerance</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">cutoff_distance_nm</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">cutoff_switch_distance_nm</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">replica_number</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">half_npt_equilibration_csv_columns</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">nvt_equilibration_temperature_coupling_frequency</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">nvt_equilibration_steps</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">nvt_equilibration_timestep_fs</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">reporting_frequency_state_nvt_equilibration</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">nve_production_timestep_fs</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">nve_production_steps</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">reporting_frequency_coordinates_unwrapped</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">reporting_frequency_coordinates_wrapped</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">reporting_frequency_state_nve_production</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">checkpoint_frequency</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">constraint_tolerance</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">elements</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">GPU_INDEX_COUNTER</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_simulate.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">wait</span><span class="se">\n</span><span class="s1">exit 0&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/submit_simulate.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunked_replicas</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">chain_submission_number</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;bash chainsubmitter.sh </span><span class="si">{</span><span class="n">chain_submission_number</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/shfiles/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_simulate.sh </span><span class="si">{</span><span class="n">dependency_type</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">partition</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;sbatch chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_simulate.sh</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_hpc_submission_analyze_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span>
    <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span>
    <span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span>
    <span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;analysis&#39;</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span>
    <span class="n">partition</span><span class="o">=</span><span class="s1">&#39;cpuonly&#39;</span><span class="p">,</span>
    <span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span>
    <span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;00:10:00&#39;</span><span class="p">,</span>
    <span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Creates job submission scripts for bwUniCluster 2.0 containing the density anlysis.</span>

<span class="sd">        Args:</span>
<span class="sd">            hpc_workspace (str, optional): The path to the hpc workspace. Defaults to &#39;workspace&#39;.</span>
<span class="sd">            hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">            hpc_scripts_folder (str, optional): The path to the python scripts folder. Defaults to &#39;workspace/HPC&#39;.</span>
<span class="sd">            environment_name (str, optional): The name of the anaconda environment containing the dependencies. Defaults to &#39;analysis&#39;.</span>
<span class="sd">            scheduler (str, optional): The queue scheduler. Defaults to &#39;SBATCH&#39;.</span>
<span class="sd">            partition (str, optional): The partition the job should be submitted to. Defaults to &#39;cpuonly&#39;.</span>
<span class="sd">            number_of_threads (int, optional): The number of requested threads. Defaults to 152.</span>
<span class="sd">            max_runtime_hh_mm_ss (str, optional): Maximum runtime for a job. Defaults to &#39;00:10:00&#39;.</span>
<span class="sd">            conda_module (bool): Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">description</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^.*?/project_description.json&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
        <span class="n">molecule_names</span><span class="p">,</span> <span class="n">chi_water_s</span><span class="p">,</span> <span class="n">temperature_s</span><span class="p">,</span> <span class="n">npt_equilibration_pressure_s</span><span class="p">,</span> <span class="n">name_list</span><span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecule_names</span><span class="p">,</span> 
                                                                                                                      <span class="bp">self</span><span class="o">.</span><span class="n">chi_water_s</span><span class="p">,</span> 
                                                                                                                      <span class="bp">self</span><span class="o">.</span><span class="n">temperature_s</span><span class="p">,</span> 
                                                                                                                      <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_pressure_s</span><span class="p">,</span>
                                                                                                                      <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">])</span>
        <span class="n">chunked_simulationsystems</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">10</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">),</span> <span class="mi">10</span><span class="p">)]</span>
        <span class="n">m_utils</span><span class="o">.</span><span class="n">hpc_submission_header</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/id</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_density.sh&#39;</span><span class="p">,</span> 
                                      <span class="sa">f</span><span class="s1">&#39;id</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_density&#39;</span><span class="p">,</span> 
                                      <span class="n">hpc_workspace</span><span class="p">,</span> 
                                      <span class="n">environment_name</span><span class="p">,</span>
                                      <span class="n">scheduler</span><span class="p">,</span>
                                      <span class="n">partition</span><span class="p">,</span>
                                      <span class="n">number_of_threads</span><span class="p">,</span>
                                      <span class="kc">None</span><span class="p">,</span>
                                      <span class="n">max_runtime_hh_mm_ss</span><span class="p">,</span>
                                      <span class="n">conda_module</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunked_simulationsystems</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/id</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_density.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_get_density.py </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">half_npt_equilibration_csv_columns</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">total_number_molecules</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">pressure</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">chi_water</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_names</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/id</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_density.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;wait</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/id</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_density.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_join_density.py </span><span class="si">{</span><span class="n">chi_water_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">temperature_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">npt_equilibration_pressure_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">name_list</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_names</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;wait</span><span class="se">\n</span><span class="s1">exit 0&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/submit_density_analysis.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">sbatch id</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_density.sh</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_hpc_submission_analyze_msd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span>
    <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span>
    <span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span>
    <span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;analysis&#39;</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span>
    <span class="n">partition</span><span class="o">=</span><span class="s1">&#39;cpuonly&#39;</span><span class="p">,</span>
    <span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span>
    <span class="n">parallel_running</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">submission_split</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;24:00:00&#39;</span><span class="p">,</span>
    <span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fit_starting_percentage</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">fit_ending_percentage</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
    <span class="n">just_conclude</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Creates job submission scripts for bwUniCluster 2.0 or HoreKa containing the mean squared displacement, self-diffusion coefficient and viscosity analysis.</span>

<span class="sd">        Args:</span>
<span class="sd">            hpc_workspace (str, optional): The path to the hpc workspace. Defaults to &#39;workspace&#39;.</span>
<span class="sd">            hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">            hpc_scripts_folder (str, optional): The path to the python scripts folder. Defaults to &#39;workspace/HPC&#39;.</span>
<span class="sd">            environment_name (str, optional): The name of the anaconda environment containing the dependencies. Defaults to &#39;analysis&#39;.</span>
<span class="sd">            scheduler (str, optional): The queue scheduler. Defaults to &#39;SBATCH&#39;.</span>
<span class="sd">            partition (str, optional): The partition the job should be submitted to. Defaults to &#39;cpuonly&#39;.</span>
<span class="sd">            number_of_threads (int, optional): The number of requested threads. Defaults to 152.</span>
<span class="sd">            parallel_running (int, optional): The number of replica analyses running in parallel. Defaults to 5.</span>
<span class="sd">            submission_split (int, optional): The number of job submissions the analysis is split in. Defaults to 4.</span>
<span class="sd">            max_runtime_hh_mm_ss (str, optional): Maximum runtime for a job. Defaults to &#39;24:00:00&#39;.</span>
<span class="sd">            conda_module (bool): Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</span>
<span class="sd">            fit_starting_percentage (int, optional): Start of the linear fit in percent of NVE production duration. Defaults to 20.</span>
<span class="sd">            fit_ending_percentage (int, optional): Ending of the linear fit in percent of NVE production duration. Defaults to 80.</span>
<span class="sd">            just_conclude (bool, optional): If true, skips the generation of job submissions scripts and just generates the conclude script. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">description</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^.*?/project_description.json&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
        <span class="n">fit_starting_frame</span><span class="p">,</span> <span class="n">fit_ending_frame</span><span class="p">,</span> <span class="n">time_between_frames</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">msd_opt_prepper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nve_production_timestep_fs</span><span class="p">,</span>
                                                                                            <span class="bp">self</span><span class="o">.</span><span class="n">nve_production_duration_ns</span><span class="p">,</span>
                                                                                            <span class="bp">self</span><span class="o">.</span><span class="n">reporting_frequency_coordinates_unwrapped</span><span class="p">,</span>
                                                                                            <span class="n">fit_starting_percentage</span><span class="p">,</span>
                                                                                            <span class="n">fit_ending_percentage</span><span class="p">)</span>
        <span class="n">molecule_names</span><span class="p">,</span> <span class="n">molecule_abbreviations</span><span class="p">,</span> <span class="n">number_dict</span><span class="p">,</span> <span class="n">total_number_molecules</span><span class="p">,</span> <span class="n">chi_water_s</span><span class="p">,</span> <span class="n">temperature_s</span><span class="p">,</span> <span class="n">npt_equilibration_pressure_s</span><span class="p">,</span> <span class="n">name_list</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecule_names</span><span class="p">,</span>
                                                                                                                                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">molecule_abbreviations</span><span class="p">,</span>
                                                                                                                                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">replica_number_dict</span><span class="p">,</span>
                                                                                                                                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">total_number_molecules</span><span class="p">,</span>
                                                                                                                                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">chi_water_s</span><span class="p">,</span>
                                                                                                                                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">temperature_s</span><span class="p">,</span>
                                                                                                                                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_pressure_s</span><span class="p">,</span>
                                                                                                                                                                                    <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">])</span>
        <span class="n">chunked_replicas</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">parallel_running</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">),</span> <span class="n">parallel_running</span><span class="p">)]</span>
        <span class="n">split_fac</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">)</span> <span class="o">/</span> <span class="n">submission_split</span><span class="p">)</span>
        <span class="n">submission_splits</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunked_replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">split_fac</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">),</span> <span class="n">split_fac</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">submission_splits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">submission_split</span><span class="p">:</span>
            <span class="n">split_fac</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">)</span> <span class="o">/</span> <span class="n">submission_split</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">submission_splits</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunked_replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">split_fac</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">),</span> <span class="n">split_fac</span><span class="p">)]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">just_conclude</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">submission_splits</span><span class="p">:</span>
                <span class="n">m_utils</span><span class="o">.</span><span class="n">hpc_submission_header</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_msd.sh&#39;</span><span class="p">,</span> 
                                              <span class="sa">f</span><span class="s1">&#39;split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_msd&#39;</span><span class="p">,</span> 
                                              <span class="n">hpc_workspace</span><span class="p">,</span> 
                                              <span class="n">environment_name</span><span class="p">,</span>
                                              <span class="n">scheduler</span><span class="p">,</span>
                                              <span class="n">partition</span><span class="p">,</span>
                                              <span class="n">number_of_threads</span><span class="p">,</span>
                                              <span class="kc">None</span><span class="p">,</span>
                                              <span class="n">max_runtime_hh_mm_ss</span><span class="p">,</span>
                                              <span class="n">conda_module</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">split</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">:</span>
                        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_msd.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_get_sdc.py </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">replica_number</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">chi_water</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_abbreviation</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_abbreviations</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">time_between_frames</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">fit_starting_frame</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">fit_ending_frame</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">pressure</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">total_number_molecules</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_names</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_name</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_msd.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;wait</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_msd.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;exit 0&#39;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/submit_msd_analysis.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">submission_splits</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;sbatch split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_msd.sh</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/conclude_msd.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;source </span><span class="si">{</span><span class="n">hpc_workspace</span><span class="si">}</span><span class="s1">/conda/etc/profile.d/conda.sh</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;conda activate </span><span class="si">{</span><span class="n">environment_name</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_join_sdc_and_comp_visc.py </span><span class="si">{</span><span class="n">total_number_molecules</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">chi_water_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">temperature_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">npt_equilibration_pressure_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">name_list</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_names</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">number_dict</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_abbreviations</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_abbreviation</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">replica_start</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;wait</span><span class="se">\n</span><span class="s1">exit 0&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_hpc_submission_analyze_hbonds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span>
    <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span>
    <span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span>
    <span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;analysis&#39;</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span>
    <span class="n">partition</span><span class="o">=</span><span class="s1">&#39;cpuonly&#39;</span><span class="p">,</span>
    <span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span>
    <span class="n">parallel_running</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">submission_split</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;24:00:00&#39;</span><span class="p">,</span>
    <span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">donors</span><span class="o">=</span><span class="s1">&#39;donor_selection_string&#39;</span><span class="p">,</span>
    <span class="n">hydrogens</span><span class="o">=</span><span class="s1">&#39;hydrogen_selection_string&#39;</span><span class="p">,</span>
    <span class="n">acceptors</span><span class="o">=</span><span class="s1">&#39;acceptors_selection_string&#39;</span><span class="p">,</span>
    <span class="n">just_conclude</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Creates job submission scripts for bwUniCluster 2.0 or HoreKa containing the mean squared displacement, self-diffusion coefficient and viscosity analysis.</span>

<span class="sd">        Args:</span>
<span class="sd">            hpc_workspace (str, optional): The path to the hpc workspace. Defaults to &#39;workspace&#39;.</span>
<span class="sd">            hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">            hpc_scripts_folder (str, optional): The path to the python scripts folder. Defaults to &#39;workspace/HPC&#39;.</span>
<span class="sd">            environment_name (str, optional): The name of the anaconda environment containing the dependencies. Defaults to &#39;analysis&#39;.</span>
<span class="sd">            scheduler (str, optional): The queue scheduler. Defaults to &#39;SBATCH&#39;.</span>
<span class="sd">            partition (str, optional): The partition the job should be submitted to. Defaults to &#39;cpuonly&#39;.</span>
<span class="sd">            number_of_threads (int, optional): The number of requested threads. Defaults to 152.</span>
<span class="sd">            parallel_running (int, optional): The number of replica analyses running in parallel. Defaults to 5.</span>
<span class="sd">            submission_split (int, optional): The number of job submissions the analysis is split in. Defaults to 4.</span>
<span class="sd">            max_runtime_hh_mm_ss (str, optional): Maximum runtime for a job. Defaults to &#39;24:00:00&#39;.</span>
<span class="sd">            conda_module (bool): Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</span>
<span class="sd">            donors (str, optional): Selection of all hydrogen bond donor atoms in MDAnalysis selection syntax. Defaults to &#39;donor_selection_string&#39;.</span>
<span class="sd">            hydrogens (str, optional): Selection of all hydrogen bond hydrogen atoms in MDAnalysis selection syntax. Defaults to &#39;hydrogens_selection_string&#39;.</span>
<span class="sd">            acceptors (str, optional): Selection of all hydrogen bond acceptor atoms in MDAnalysis selection syntax. Defaults to &#39;acceptors_selection_string&#39;.</span>
<span class="sd">            just_conclude (bool, optional): If true, skips the generation of job submissions scripts and just generates the conclude script. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">description</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^.*?/project_description.json&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
        <span class="n">molecule_names</span><span class="p">,</span> <span class="n">number_dict</span><span class="p">,</span> <span class="n">chi_water_s</span><span class="p">,</span> <span class="n">temperature_s</span><span class="p">,</span> <span class="n">npt_equilibration_pressure_s</span><span class="p">,</span> <span class="n">molecule_abbreviations</span><span class="p">,</span> <span class="n">name_list</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecule_names</span><span class="p">,</span>
                                                                                                                                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">replica_number_dict</span><span class="p">,</span>
                                                                                                                                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">chi_water_s</span><span class="p">,</span>
                                                                                                                                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">temperature_s</span><span class="p">,</span>
                                                                                                                                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_pressure_s</span><span class="p">,</span>
                                                                                                                                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">molecule_abbreviations</span><span class="p">,</span>
                                                                                                                                                                                                <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">])</span>
        <span class="n">chunked_replicas</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">parallel_running</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">),</span> <span class="n">parallel_running</span><span class="p">)]</span>
        <span class="n">split_fac</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">)</span> <span class="o">/</span> <span class="n">submission_split</span><span class="p">)</span>
        <span class="n">submission_splits</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunked_replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">split_fac</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">),</span> <span class="n">split_fac</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">submission_splits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">submission_split</span><span class="p">:</span>
            <span class="n">split_fac</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">)</span> <span class="o">/</span> <span class="n">submission_split</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">submission_splits</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunked_replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">split_fac</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">),</span> <span class="n">split_fac</span><span class="p">)]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">just_conclude</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">submission_splits</span><span class="p">:</span>
                <span class="n">m_utils</span><span class="o">.</span><span class="n">hpc_submission_header</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_hbonds.sh&#39;</span><span class="p">,</span> 
                                              <span class="sa">f</span><span class="s1">&#39;split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_hbonds&#39;</span><span class="p">,</span> 
                                              <span class="n">hpc_workspace</span><span class="p">,</span> 
                                              <span class="n">environment_name</span><span class="p">,</span>
                                              <span class="n">scheduler</span><span class="p">,</span>
                                              <span class="n">partition</span><span class="p">,</span>
                                              <span class="n">number_of_threads</span><span class="p">,</span>
                                              <span class="kc">None</span><span class="p">,</span>
                                              <span class="n">max_runtime_hh_mm_ss</span><span class="p">,</span>
                                              <span class="n">conda_module</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">split</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">:</span>
                        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_hbonds.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_get_hbonds.py </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">replica_number</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">chi_water</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">pressure</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">total_number_molecules</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_names</span><span class="si">}</span><span class="s1"> &quot;</span><span class="si">{</span><span class="n">donors</span><span class="si">}</span><span class="s1">&quot; &quot;</span><span class="si">{</span><span class="n">hydrogens</span><span class="si">}</span><span class="s1">&quot; &quot;</span><span class="si">{</span><span class="n">acceptors</span><span class="si">}</span><span class="s1">&quot; &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_hbonds.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;wait</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_hbonds.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;exit 0&#39;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/submit_hbonds_analysis.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">submission_splits</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;sbatch split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_hbonds.sh</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/conclude_hbonds.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;source </span><span class="si">{</span><span class="n">hpc_workspace</span><span class="si">}</span><span class="s1">/conda/etc/profile.d/conda.sh</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;conda activate </span><span class="si">{</span><span class="n">environment_name</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_join_hbonds.py </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">name_list</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">number_dict</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">chi_water_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">temperature_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">npt_equilibration_pressure_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_names</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_abbreviations</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_abbreviation</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">replica_start</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;wait</span><span class="se">\n</span><span class="s1">exit 0&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hpc_extend_replica_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Creates newly added replica folders to the system folders on the hpc.</span>

<span class="sd">        Args:</span>
<span class="sd">            hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">folder_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">:</span>
            <span class="n">folder_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">replica</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/extend_replica_folders.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">folder_string</span> <span class="ow">in</span> <span class="n">folder_list</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;mkdir </span><span class="si">{</span><span class="n">folder_string</span><span class="si">}</span><span class="s1"></span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hpc_job_checker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
    <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span> 
    <span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span> 
    <span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span> 
    <span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;openmm_new&#39;</span><span class="p">,</span> 
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">energy_shift_tolerance_percent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Creates a bash script to check the overall status of the simulations on the hpc. Checked properties are doneness percent, average temperature and total energy shift.</span>

<span class="sd">        Args:</span>
<span class="sd">            hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">            hpc_scripts_folder (str, optional): The path to the python scripts folder. Defaults to &#39;workspace/HPC&#39;.</span>
<span class="sd">            hpc_workspace (str, optional): The path to the hpc workspace. Defaults to &#39;workspace&#39;.</span>
<span class="sd">            environment_name (str, optional): The name of the anaconda environment containing the dependencies. Defaults to &#39;openmm_new&#39;.</span>
<span class="sd">            verbose (bool, optional): If true checks average temperature and total energy shift. Defaults to True.</span>
<span class="sd">            energy_shift_tolerance_percent (int, optional): The tolerated energy shift in percent. If the energy shift of a simulation is greater, a warning is issued. Defaults to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">system_file_list_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">:</span>
            <span class="n">system_file_list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
        <span class="n">system_file_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">system_file_list_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">4</span><span class="p">])))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/system_list.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">file_str</span> <span class="ow">in</span> <span class="n">system_file_list</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;</span><span class="si">{</span><span class="n">file_str</span><span class="si">}</span><span class="s1"></span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">replica_file_list_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">:</span>
            <span class="n">replica_file_list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">replica</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
        <span class="n">replica_file_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">replica_file_list_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])))</span>
        <span class="n">replica_file_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;finalize&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/replica_list.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">file_str</span> <span class="ow">in</span> <span class="n">replica_file_list</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;</span><span class="si">{</span><span class="n">file_str</span><span class="si">}</span><span class="s1"></span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/job_checker.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span>
<span class="s1">source </span><span class="si">{</span><span class="n">hpc_workspace</span><span class="si">}</span><span class="s1">/conda/etc/profile.d/conda.sh</span>
<span class="s1">conda activate </span><span class="si">{</span><span class="n">environment_name</span><span class="si">}</span><span class="s1"></span>
<span class="s1">python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/job_checker.py </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nvt_equilibration_duration_ns</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nve_production_duration_ns</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">verbose</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">energy_shift_tolerance_percent</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_duration_ns</span><span class="si">}</span><span class="s1"></span>
<span class="s1">exit 0</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_done_jobs_from_systems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_to_job_checks</span><span class="o">=</span><span class="s1">&#39;workdir/job_checks.txt&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes all systems that are done according to the job checker from the project.</span>

<span class="sd">        Args:</span>
<span class="sd">            path_to_job_checks (str, optional): The path to the job checker output file. Defaults to &#39;workdir/job_checks.txt&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path_to_job_checks</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">not_done_job_list_</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">if</span> <span class="s1">&#39;not yet adjusted&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]</span>
            <span class="n">not_done_job_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[:</span><span class="o">-</span><span class="mi">17</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">not_done_job_list_</span><span class="p">]</span>
        <span class="n">filtered_systems</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">not_done_job_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
                    <span class="n">filtered_systems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span> <span class="o">=</span> <span class="n">filtered_systems</span>

    <span class="k">def</span> <span class="nf">remove_done_jobs_from_replicas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_to_job_checks</span><span class="o">=</span><span class="s1">&#39;workdir/job_checks.txt&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes all replicas that are done according to the job checker from the project.</span>

<span class="sd">        Args:</span>
<span class="sd">            path_to_job_checks (str, optional): The path to the job checker output file. Defaults to &#39;workdir/job_checks.txt&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path_to_job_checks</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">not_done_job_list_</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">if</span> <span class="s1">&#39;not yet finished&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]</span>
            <span class="n">not_done_job_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[:</span><span class="o">-</span><span class="mi">17</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">not_done_job_list_</span><span class="p">]</span>
        <span class="n">filtered_replicas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">not_done_job_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">replica</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">string</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+$&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">())</span> <span class="o">==</span> <span class="n">replica</span><span class="o">.</span><span class="n">replica_number</span><span class="p">:</span>
                    <span class="n">filtered_replicas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replica</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span> <span class="o">=</span> <span class="n">filtered_replicas</span>

    <span class="k">def</span> <span class="nf">overcharge_replicas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total_number_molecules</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">overcharge_amount</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Adds the overcharge amount to the replicas of the systems specified by total number of molecules.</span>

<span class="sd">        Args:</span>
<span class="sd">            total_number_molecules (int, optional): Number of molecules that are placed in the simulation box. Defaults to 1000.</span>
<span class="sd">            overcharge_amount (int, optional): Amount of replicas that should be added. Defaults to 10.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">filtered_systems</span> <span class="o">=</span> <span class="p">[</span><span class="n">system</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span> <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">total_number_molecules</span> <span class="ow">in</span> <span class="n">total_number_molecules</span><span class="p">]</span>
        <span class="n">replica_count</span> <span class="o">=</span> <span class="nb">range</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">replica_count</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">replica_start</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replica_count</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">replica_start</span> <span class="o">+</span> <span class="n">overcharge_amount</span><span class="p">))</span>
        <span class="n">parameter_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">filtered_systems</span><span class="p">,</span> <span class="n">replica_count</span><span class="p">]</span>
        <span class="n">combination_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">parameter_list</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">combination_list</span><span class="p">:</span>
            <span class="n">system</span><span class="p">,</span> <span class="n">replica_number</span> <span class="o">=</span> <span class="n">combination</span>
            <span class="n">replica</span> <span class="o">=</span> <span class="n">Replica</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">replica_number</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replica</span><span class="p">)</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;with </span><span class="si">{</span><span class="n">overcharge_amount</span><span class="si">}</span><span class="s1"> replicas&#39;</span>
        <span class="n">m_utils</span><span class="o">.</span><span class="n">add_json_entry</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;project&#39;</span><span class="p">,</span> <span class="n">subkey</span><span class="o">=</span><span class="s1">&#39;simulation_parameters&#39;</span><span class="p">,</span> <span class="n">subsubkey</span><span class="o">=</span><span class="s1">&#39;overcharged_boxes&#39;</span><span class="p">,</span> <span class="n">subsubsubkey</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">total_number_molecules</span><span class="si">}</span><span class="s1"> molecules&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replica_number_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">total_number_molecules</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">replica_count</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">replica_start</span> <span class="o">+</span> <span class="n">overcharge_amount</span>

    <span class="k">def</span> <span class="nf">transfer_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">hpc_folder_old</span><span class="o">=</span><span class="s1">&#39;workspace_old/project_name&#39;</span><span class="p">,</span> 
    <span class="n">hpc_folder_new</span><span class="o">=</span><span class="s1">&#39;workspace_new/project_name&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Transfers a project between two workspaces.</span>

<span class="sd">        Args:</span>
<span class="sd">            hpc_folder_old (str, optional): The path to the old project folder on the hpc. Defaults to &#39;workspace_old/project_name&#39;.</span>
<span class="sd">            hpc_folder_new (str, optional): The path to the new project folder on the hpc. Defaults to &#39;workspace_new/project_name&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">system_file_list_old_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">system_file_list_new_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">:</span>
            <span class="n">system_file_list_old_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
            <span class="n">system_file_list_new_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
        <span class="n">system_file_list_old</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">system_file_list_old_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">4</span><span class="p">])))</span>
        <span class="n">system_file_list_new</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">system_file_list_new_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">4</span><span class="p">])))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/transfer_project.py&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;import shutil</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">file_str_old</span><span class="p">,</span> <span class="n">file_str_new</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">system_file_list_old</span><span class="p">,</span> <span class="n">system_file_list_new</span><span class="p">):</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">file_str_old</span><span class="si">}</span><span class="s1">/npt_equilibration&quot;, r&quot;</span><span class="si">{</span><span class="n">file_str_new</span><span class="si">}</span><span class="s1">/npt_equilibration&quot;)</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">replica_file_list_old_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">replica_file_list_new_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">:</span>
            <span class="n">replica_file_list_old_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">replica</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
            <span class="n">replica_file_list_new_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">replica</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
        <span class="n">replica_file_list_old</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">replica_file_list_old_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])))</span>
        <span class="n">replica_file_list_new</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">replica_file_list_new_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/transfer_project.py&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">file_str_old</span><span class="p">,</span> <span class="n">file_str_new</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">replica_file_list_old</span><span class="p">,</span> <span class="n">replica_file_list_new</span><span class="p">):</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">file_str_old</span><span class="si">}</span><span class="s1">&quot;, r&quot;</span><span class="si">{</span><span class="n">file_str_new</span><span class="si">}</span><span class="s1">&quot;)</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/transfer_project.py&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/boxes&quot;, r&quot;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/boxes&quot;)</span>
<span class="s1">shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/forcefield&quot;, r&quot;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/forcefield&quot;)</span>
<span class="s1">shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/hpc_submission&quot;, r&quot;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/hpc_submission&quot;)</span>
<span class="s1">shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/molecules&quot;, r&quot;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/molecules&quot;)</span>
<span class="s1">shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/results&quot;, r&quot;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/results&quot;)</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">workdir</span><span class="p">,</span> <span class="n">simulation_platform</span><span class="o">=</span><span class="s1">&#39;CUDA&#39;</span><span class="p">,</span> <span class="n">simulation_properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;DeviceIndex&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="s1">&#39;double&#39;</span><span class="p">},</span> <span class="n">total_number_molecules</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">],</span> <span class="n">init_box_side_length</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="n">chi_water_s</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">temperature_s</span><span class="o">=</span><span class="p">[</span><span class="mf">298.15</span><span class="p">],</span> <span class="n">npt_equilibration_pressure_s</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">npt_equilibration_pressure_coupling_frequency</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">npt_equilibration_temperature_coupling_frequency</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">npt_equilibration_timestep_fs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">npt_equilibration_duration_ns</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">reporting_frequency_state_npt_equilibration</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">nvt_equilibration_temperature_coupling_frequency</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">nvt_equilibration_timestep_fs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nvt_equilibration_duration_ns</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">reporting_frequency_state_nvt_equilibration</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">nve_production_timestep_fs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nve_production_duration_ns</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">reporting_frequency_coordinates_unwrapped</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">reporting_frequency_coordinates_wrapped</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span> <span class="n">reporting_frequency_state_nve_production</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span> <span class="n">replica_count</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pme_error_tolerance</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">constraint_tolerance</span><span class="o">=</span><span class="mf">1e-07</span><span class="p">,</span> <span class="n">cutoff_distance_nm</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">cutoff_switch_distance_nm</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>The project holds all parameters and functions to do a complete systematic simulation of different systems in openmm.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>workdir</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path at which the project should be stored.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>simulation_platform</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The platform the simulation should run on. Defaults to 'CUDA'.</p></td>
          <td>
                <code>&#39;CUDA&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>simulation_properties</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>The platform properties for the simulation. Defaults to {'DeviceIndex': '0', 'Precision': 'double'}.</p></td>
          <td>
                <code>{&#39;DeviceIndex&#39;: &#39;0&#39;, &#39;Precision&#39;: &#39;double&#39;}</code>
          </td>
        </tr>
        <tr>
          <td><code>total_number_molecules</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>A list with the number of molecules that should be placed in the simulation box. Defaults to [1000].</p></td>
          <td>
                <code>[1000]</code>
          </td>
        </tr>
        <tr>
          <td><code>init_box_side_length</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>The initial box side lengths that should be used by packmol. Defaults to [30].</p></td>
          <td>
                <code>[30]</code>
          </td>
        </tr>
        <tr>
          <td><code>chi_water_s</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>A list with all different molar fractions of water that should be simulated. Defaults to [0,0.5,1].</p></td>
          <td>
                <code>[0, 0.5, 1]</code>
          </td>
        </tr>
        <tr>
          <td><code>temperature_s</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>A list with all different temperatures in kelvin at which the boxes should be simulated. Defaults to [298.15].</p></td>
          <td>
                <code>[298.15]</code>
          </td>
        </tr>
        <tr>
          <td><code>npt_equilibration_pressure_s</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>A list with all pressures in bar at which the boxes should be simulated. Defaults to [1].</p></td>
          <td>
                <code>[1]</code>
          </td>
        </tr>
        <tr>
          <td><code>npt_equilibration_pressure_coupling_frequency</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The pressure coupling frequency at which the Monte Carlo barostat should interact with the system and attempt a Monte Carlo move to adjust the volume during the NpT equilibration in simulation steps. Defaults to 25.</p></td>
          <td>
                <code>25</code>
          </td>
        </tr>
        <tr>
          <td><code>npt_equilibration_temperature_coupling_frequency</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The friction coefficient of the Langevin thermostat during the NpT equilibration in inverse picoseconds. Defaults to 0.1.</p></td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr>
          <td><code>npt_equilibration_timestep_fs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The integration time step during the NpT equilibration in femtoseconds. Defaults to 2.</p></td>
          <td>
                <code>2</code>
          </td>
        </tr>
        <tr>
          <td><code>npt_equilibration_duration_ns</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The duration of the NpT equilibration in nanoseconds. Defaults to 10.</p></td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr>
          <td><code>reporting_frequency_state_npt_equilibration</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The reporting frequency of the openMM StateDataReporter in simulation steps during the NpT equilibration. Defaults to 500.</p></td>
          <td>
                <code>500</code>
          </td>
        </tr>
        <tr>
          <td><code>nvt_equilibration_temperature_coupling_frequency</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The friction coefficient of the Langevin thermostat during the NVT equilibration in inverse picoseconds. Defaults to 0.1.</p></td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr>
          <td><code>nvt_equilibration_timestep_fs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The integration time step during the NVT equilibration in femtoseconds. Defaults to 2.</p></td>
          <td>
                <code>2</code>
          </td>
        </tr>
        <tr>
          <td><code>nvt_equilibration_duration_ns</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The duration of the NVT equilibration in nanoseconds. Defaults to 20.</p></td>
          <td>
                <code>20</code>
          </td>
        </tr>
        <tr>
          <td><code>reporting_frequency_state_nvt_equilibration</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The reporting frequency of the openMM StateDataReporter in simulation steps during the NVT equilibration. Defaults to 2000.</p></td>
          <td>
                <code>2000</code>
          </td>
        </tr>
        <tr>
          <td><code>nve_production_timestep_fs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The integration time step during the NVE production in femtoseconds. Defaults to 1.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>nve_production_duration_ns</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The duration of the NVE production in nanoseconds. Defaults to 20.</p></td>
          <td>
                <code>20</code>
          </td>
        </tr>
        <tr>
          <td><code>reporting_frequency_coordinates_unwrapped</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The reporting frequency of the trajectory with unwrapped coordinates in simulation steps during the NVE production. Defaults to 2000.</p></td>
          <td>
                <code>2000</code>
          </td>
        </tr>
        <tr>
          <td><code>reporting_frequency_coordinates_wrapped</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The reporting frequency of the trajectory with wrapped coordinates in simulation steps during the NVE production. Defaults to 4000.</p></td>
          <td>
                <code>4000</code>
          </td>
        </tr>
        <tr>
          <td><code>reporting_frequency_state_nve_production</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The reporting frequency of the openMM StateDataReporter in simulation steps during the NVE production. Defaults to 4000.</p></td>
          <td>
                <code>4000</code>
          </td>
        </tr>
        <tr>
          <td><code>replica_count</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of times the simulation of one system should be replicated. Defaults to 10.</p></td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr>
          <td><code>pme_error_tolerance</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>Decides how large the grid for PME is together with the cutoff. Defaults to 0.000001.</p></td>
          <td>
                <code>1e-06</code>
          </td>
        </tr>
        <tr>
          <td><code>constraint_tolerance</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The constraint tolerance specifies the distance tolerance within which constraints are maintained, as a fraction of the constrained distance. Defaults to 0.0000001</p></td>
          <td>
                <code>1e-07</code>
          </td>
        </tr>
        <tr>
          <td><code>cutoff_distance_nm</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The cutoff distance for nonbonded interactions in nanometers. Defaults to 1.2.</p></td>
          <td>
                <code>1.2</code>
          </td>
        </tr>
        <tr>
          <td><code>cutoff_switch_distance_nm</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>Starting point of the switching function that makes the energy go smoothly to 0 at the cutoff distance in nanometers. Defaults to 1.0.</p></td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<span class="n">workdir</span><span class="p">,</span>
<span class="n">simulation_platform</span><span class="o">=</span><span class="s1">&#39;CUDA&#39;</span><span class="p">,</span>
<span class="n">simulation_properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;DeviceIndex&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="s1">&#39;double&#39;</span><span class="p">},</span>
<span class="n">total_number_molecules</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">],</span>
<span class="n">init_box_side_length</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span>
<span class="n">chi_water_s</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="n">temperature_s</span><span class="o">=</span><span class="p">[</span><span class="mf">298.15</span><span class="p">],</span>
<span class="n">npt_equilibration_pressure_s</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="n">npt_equilibration_pressure_coupling_frequency</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
<span class="n">npt_equilibration_temperature_coupling_frequency</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="n">npt_equilibration_timestep_fs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="n">npt_equilibration_duration_ns</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="n">reporting_frequency_state_npt_equilibration</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
<span class="n">nvt_equilibration_temperature_coupling_frequency</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="n">nvt_equilibration_timestep_fs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="n">nvt_equilibration_duration_ns</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="n">reporting_frequency_state_nvt_equilibration</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
<span class="n">nve_production_timestep_fs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="n">nve_production_duration_ns</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="n">reporting_frequency_coordinates_unwrapped</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
<span class="n">reporting_frequency_coordinates_wrapped</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span>
<span class="n">reporting_frequency_state_nve_production</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span>
<span class="n">replica_count</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="n">pme_error_tolerance</span><span class="o">=</span><span class="mf">0.000001</span><span class="p">,</span>
<span class="n">constraint_tolerance</span><span class="o">=</span><span class="mf">0.0000001</span><span class="p">,</span>
<span class="n">cutoff_distance_nm</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span>
<span class="n">cutoff_switch_distance_nm</span><span class="o">=</span><span class="mf">1.0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;The project holds all parameters and functions to do a complete systematic simulation of different systems in openmm.</span>

<span class="sd">    Args:</span>
<span class="sd">        workdir (str): The path at which the project should be stored.</span>
<span class="sd">        simulation_platform (str, optional): The platform the simulation should run on. Defaults to &#39;CUDA&#39;.</span>
<span class="sd">        simulation_properties (dict, optional): The platform properties for the simulation. Defaults to {&#39;DeviceIndex&#39;: &#39;0&#39;, &#39;Precision&#39;: &#39;double&#39;}.</span>
<span class="sd">        total_number_molecules (list, optional): A list with the number of molecules that should be placed in the simulation box. Defaults to [1000].</span>
<span class="sd">        init_box_side_length (list, optional): The initial box side lengths that should be used by packmol. Defaults to [30].</span>
<span class="sd">        chi_water_s (list, optional): A list with all different molar fractions of water that should be simulated. Defaults to [0,0.5,1].</span>
<span class="sd">        temperature_s (list, optional): A list with all different temperatures in kelvin at which the boxes should be simulated. Defaults to [298.15].</span>
<span class="sd">        npt_equilibration_pressure_s (list, optional): A list with all pressures in bar at which the boxes should be simulated. Defaults to [1].</span>
<span class="sd">        npt_equilibration_pressure_coupling_frequency (int, optional): The pressure coupling frequency at which the Monte Carlo barostat should interact with the system and attempt a Monte Carlo move to adjust the volume during the NpT equilibration in simulation steps. Defaults to 25.</span>
<span class="sd">        npt_equilibration_temperature_coupling_frequency (float, optional): The friction coefficient of the Langevin thermostat during the NpT equilibration in inverse picoseconds. Defaults to 0.1.</span>
<span class="sd">        npt_equilibration_timestep_fs (int, optional): The integration time step during the NpT equilibration in femtoseconds. Defaults to 2.</span>
<span class="sd">        npt_equilibration_duration_ns (int, optional): The duration of the NpT equilibration in nanoseconds. Defaults to 10.</span>
<span class="sd">        reporting_frequency_state_npt_equilibration (int, optional): The reporting frequency of the openMM StateDataReporter in simulation steps during the NpT equilibration. Defaults to 500.</span>
<span class="sd">        nvt_equilibration_temperature_coupling_frequency (float, optional): The friction coefficient of the Langevin thermostat during the NVT equilibration in inverse picoseconds. Defaults to 0.1.</span>
<span class="sd">        nvt_equilibration_timestep_fs (int, optional): The integration time step during the NVT equilibration in femtoseconds. Defaults to 2.</span>
<span class="sd">        nvt_equilibration_duration_ns (int, optional): The duration of the NVT equilibration in nanoseconds. Defaults to 20.</span>
<span class="sd">        reporting_frequency_state_nvt_equilibration (int, optional): The reporting frequency of the openMM StateDataReporter in simulation steps during the NVT equilibration. Defaults to 2000.</span>
<span class="sd">        nve_production_timestep_fs (int, optional): The integration time step during the NVE production in femtoseconds. Defaults to 1.</span>
<span class="sd">        nve_production_duration_ns (int, optional): The duration of the NVE production in nanoseconds. Defaults to 20.</span>
<span class="sd">        reporting_frequency_coordinates_unwrapped (int, optional): The reporting frequency of the trajectory with unwrapped coordinates in simulation steps during the NVE production. Defaults to 2000.</span>
<span class="sd">        reporting_frequency_coordinates_wrapped (int, optional): The reporting frequency of the trajectory with wrapped coordinates in simulation steps during the NVE production. Defaults to 4000.</span>
<span class="sd">        reporting_frequency_state_nve_production (int, optional): The reporting frequency of the openMM StateDataReporter in simulation steps during the NVE production. Defaults to 4000.</span>
<span class="sd">        replica_count (int, optional): The number of times the simulation of one system should be replicated. Defaults to 10.</span>
<span class="sd">        pme_error_tolerance (float, optional): Decides how large the grid for PME is together with the cutoff. Defaults to 0.000001.</span>
<span class="sd">        constraint_tolerance (float, optional): The constraint tolerance specifies the distance tolerance within which constraints are maintained, as a fraction of the constrained distance. Defaults to 0.0000001</span>
<span class="sd">        cutoff_distance_nm (float, optional): The cutoff distance for nonbonded interactions in nanometers. Defaults to 1.2.</span>
<span class="sd">        cutoff_switch_distance_nm (float, optional): Starting point of the switching function that makes the energy go smoothly to 0 at the cutoff distance in nanometers. Defaults to 1.0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">workdir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="n">workdir</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">moldir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/molecules&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">boxdir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/boxes&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resdir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/results&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/hpc_submission&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">forcedir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/forcefield&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">res_rawdir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">resdir</span><span class="si">}</span><span class="s1">/raw_data&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">res_partsdir</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">directory_maker</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">resdir</span><span class="si">}</span><span class="s1">/parts&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">molecules</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">simulation_boxes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">molecule_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">molecule_number_of_atoms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">molecule_abbreviations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mixture_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">forcefields</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">chi_water_s</span> <span class="o">=</span> <span class="n">chi_water_s</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">total_number_molecules</span> <span class="o">=</span> <span class="n">total_number_molecules</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">init_box_side_length</span> <span class="o">=</span> <span class="n">init_box_side_length</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">water_name</span> <span class="o">=</span> <span class="s1">&#39;Water&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">water_abbreviation</span> <span class="o">=</span> <span class="s1">&#39;HOH&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replica_number_dict</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">simulation_platform</span> <span class="o">=</span> <span class="n">simulation_platform</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">simulation_properties</span> <span class="o">=</span> <span class="n">simulation_properties</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">temperature_s</span> <span class="o">=</span> <span class="n">temperature_s</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_pressure_s</span> <span class="o">=</span> <span class="n">npt_equilibration_pressure_s</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_pressure_coupling_frequency</span> <span class="o">=</span> <span class="n">npt_equilibration_pressure_coupling_frequency</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_temperature_coupling_frequency</span> <span class="o">=</span> <span class="n">npt_equilibration_temperature_coupling_frequency</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_timestep_fs</span> <span class="o">=</span> <span class="n">npt_equilibration_timestep_fs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_duration_ns</span> <span class="o">=</span> <span class="n">npt_equilibration_duration_ns</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nvt_equilibration_temperature_coupling_frequency</span> <span class="o">=</span> <span class="n">nvt_equilibration_temperature_coupling_frequency</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nvt_equilibration_timestep_fs</span> <span class="o">=</span> <span class="n">nvt_equilibration_timestep_fs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nvt_equilibration_duration_ns</span> <span class="o">=</span> <span class="n">nvt_equilibration_duration_ns</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nve_production_timestep_fs</span> <span class="o">=</span> <span class="n">nve_production_timestep_fs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nve_production_duration_ns</span> <span class="o">=</span> <span class="n">nve_production_duration_ns</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reporting_frequency_coordinates_unwrapped</span> <span class="o">=</span> <span class="n">reporting_frequency_coordinates_unwrapped</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reporting_frequency_coordinates_wrapped</span> <span class="o">=</span> <span class="n">reporting_frequency_coordinates_wrapped</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reporting_frequency_state_npt_equilibration</span> <span class="o">=</span> <span class="n">reporting_frequency_state_npt_equilibration</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reporting_frequency_state_nvt_equilibration</span> <span class="o">=</span> <span class="n">reporting_frequency_state_nvt_equilibration</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reporting_frequency_state_nve_production</span> <span class="o">=</span> <span class="n">reporting_frequency_state_nve_production</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replica_count</span> <span class="o">=</span> <span class="n">replica_count</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pme_error_tolerance</span> <span class="o">=</span> <span class="n">pme_error_tolerance</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">constraint_tolerance</span> <span class="o">=</span> <span class="n">constraint_tolerance</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cutoff_distance_nm</span> <span class="o">=</span> <span class="n">cutoff_distance_nm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cutoff_switch_distance_nm</span> <span class="o">=</span> <span class="n">cutoff_switch_distance_nm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">half_npt_equilibration_csv_columns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((((</span><span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_duration_ns</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_timestep_fs</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">))</span><span class="o">/</span><span class="n">reporting_frequency_state_npt_equilibration</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">create_description</span><span class="p">()</span>
    <span class="n">m_utils</span><span class="o">.</span><span class="n">add_chainsubmitter_script</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.add_forcefield" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_forcefield</span><span class="p">(</span><span class="n">Forcefield</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.add_forcefield" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Adds a force field to the project.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>Forcefield</code></td>
          <td>
                <code>object</code>
          </td>
          <td><p>Contains information on the force field.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_forcefield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Forcefield</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Adds a force field to the project.</span>

<span class="sd">    Args:</span>
<span class="sd">        Forcefield (object): Contains information on the force field.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">forcefields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Forcefield</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Forcefield</span><span class="o">.</span><span class="n">elements</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">Forcefield</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
    <span class="n">json_structure</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">jsonize_forcefield</span><span class="p">(</span><span class="n">Forcefield</span><span class="p">)</span>
    <span class="n">m_utils</span><span class="o">.</span><span class="n">add_json_entry</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">json_structure</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;force fields&#39;</span><span class="p">,</span> <span class="n">subkey</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Forcefield</span><span class="o">.</span><span class="n">ff_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.add_mixture" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_mixture</span><span class="p">(</span><span class="n">Mixture</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.add_mixture" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Adds a mixture to the project.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>Mixture</code></td>
          <td>
                <code>object</code>
          </td>
          <td><p>Contains information on the mixture that is simulated.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_mixture</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Mixture</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Adds a mixture to the project.</span>

<span class="sd">    Args:</span>
<span class="sd">        Mixture (object): Contains information on the mixture that is simulated.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">mixture_dict</span> <span class="o">=</span> <span class="n">Mixture</span><span class="o">.</span><span class="n">mixture_dict</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.add_molecule" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_molecule</span><span class="p">(</span><span class="n">Molecule</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.add_molecule" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Adds a molecule to the project.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>Molecule</code></td>
          <td>
                <code>object</code>
          </td>
          <td><p>Contains information on the molecule that is used for packing with packmol and to identify it.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Molecule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Adds a molecule to the project.</span>

<span class="sd">    Args:</span>
<span class="sd">        Molecule (object): Contains information on the molecule that is used for packing with packmol and to identify it.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">use_as_water</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">water_name</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">water_abbreviation</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">abbreviation</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Molecule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecule_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Molecule</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecule_number_of_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecule_abbreviations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Molecule</span><span class="o">.</span><span class="n">abbreviation</span><span class="p">)</span>
    <span class="n">json_structure</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">jsonize_molecule</span><span class="p">(</span><span class="n">Molecule</span><span class="p">)</span>
    <span class="n">m_utils</span><span class="o">.</span><span class="n">add_json_entry</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">json_structure</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;molecules&#39;</span><span class="p">,</span> <span class="n">subkey</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Molecule</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.adjust_to_correct_density" class="doc doc-heading">
<code class="highlight language-python"><span class="n">adjust_to_correct_density</span><span class="p">()</span></code>

<a href="#mixturemm.mixturemm.Project.adjust_to_correct_density" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Runs the NpT equilibration to adjust the system volume and density to the correct value.</p>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">adjust_to_correct_density</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Runs the NpT equilibration to adjust the system volume and density to the correct value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">:</span>
        <span class="n">system</span><span class="o">.</span><span class="n">npt_equilibration</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.create_description" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_description</span><span class="p">()</span></code>

<a href="#mixturemm.mixturemm.Project.create_description" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a .json file with all input arguments of the project and info on all added files.</p>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates a .json file with all input arguments of the project and info on all added files.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">json_structure</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">jsonize_project</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">json_structure</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">m_utils</span><span class="o">.</span><span class="n">merge_project_descriptions</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span><span class="p">,</span> <span class="n">json_structure</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.create_hpc_submission_adjust_to_correct_density" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_hpc_submission_adjust_to_correct_density</span><span class="p">(</span><span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span> <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span> <span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span> <span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;openmm_new&#39;</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span> <span class="n">partition</span><span class="o">=</span><span class="s1">&#39;accelerated&#39;</span><span class="p">,</span> <span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span> <span class="n">number_of_gpus</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_number_of_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;24:00:00&#39;</span><span class="p">,</span> <span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chain_submission_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dependency_type</span><span class="o">=</span><span class="s1">&#39;afternotok&#39;</span><span class="p">,</span> <span class="n">checkpoint_frequency</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.create_hpc_submission_adjust_to_correct_density" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates job submission scripts for bwUniCluster 2.0 or HoreKa containing the NpT equilibration.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hpc_workspace</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the hpc workspace. Defaults to 'workspace'.</p></td>
          <td>
                <code>&#39;workspace&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hpc_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the project folder on the hpc. Defaults to 'workspace/project_name'.</p></td>
          <td>
                <code>&#39;workspace/project_name&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hpc_scripts_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the python scripts folder. Defaults to 'workspace/HPC'.</p></td>
          <td>
                <code>&#39;workspace/HPC&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>environment_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the anaconda environment containing the dependencies. Defaults to 'openmmfin'.</p></td>
          <td>
                <code>&#39;openmm_new&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scheduler</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The queue scheduler. Defaults to 'SBATCH'.</p></td>
          <td>
                <code>&#39;SBATCH&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>partition</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The partition the job should be submitted to. Defaults to 'accelerated'.</p></td>
          <td>
                <code>&#39;accelerated&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>number_of_threads</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of requested threads. Defaults to 152.</p></td>
          <td>
                <code>152</code>
          </td>
        </tr>
        <tr>
          <td><code>number_of_gpus</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of GPUs requested on a node. Defaults to 4.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr>
          <td><code>chunk_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of simulations to submit in a chunk, should correspond to the number of requested GPUs. Defaults to 4.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr>
          <td><code>max_number_of_jobs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Maximum number of job submissions allowed on the hpc. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>max_runtime_hh_mm_ss</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Maximum runtime for a job. Defaults to '24:00:00'.</p></td>
          <td>
                <code>&#39;24:00:00&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>conda_module</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>chain_submission_number</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of job submissions that should be submitted as a sequential chain job. Defaults to 1.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>dependency_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Dependency keyword of the SLURM workload manager for chain jobs. Defaults to 'afternotok'.</p></td>
          <td>
                <code>&#39;afternotok&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>checkpoint_frequency</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The frequency at which checkpoints are saved to restart from once a job continues. Defaults to 10000.</p></td>
          <td>
                <code>10000</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_hpc_submission_adjust_to_correct_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span>
<span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span>
<span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span>
<span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;openmm_new&#39;</span><span class="p">,</span>
<span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span>
<span class="n">partition</span><span class="o">=</span><span class="s1">&#39;accelerated&#39;</span><span class="p">,</span>
<span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span>
<span class="n">number_of_gpus</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="n">chunk_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="n">max_number_of_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;24:00:00&#39;</span><span class="p">,</span>
<span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="n">chain_submission_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="n">dependency_type</span><span class="o">=</span><span class="s1">&#39;afternotok&#39;</span><span class="p">,</span>
<span class="n">checkpoint_frequency</span><span class="o">=</span><span class="mi">10000</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates job submission scripts for bwUniCluster 2.0 or HoreKa containing the NpT equilibration.</span>

<span class="sd">    Args:</span>
<span class="sd">        hpc_workspace (str, optional): The path to the hpc workspace. Defaults to &#39;workspace&#39;.</span>
<span class="sd">        hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">        hpc_scripts_folder (str, optional): The path to the python scripts folder. Defaults to &#39;workspace/HPC&#39;.</span>
<span class="sd">        environment_name (str, optional): The name of the anaconda environment containing the dependencies. Defaults to &#39;openmmfin&#39;.</span>
<span class="sd">        scheduler (str, optional): The queue scheduler. Defaults to &#39;SBATCH&#39;.</span>
<span class="sd">        partition (str, optional): The partition the job should be submitted to. Defaults to &#39;accelerated&#39;.</span>
<span class="sd">        number_of_threads (int, optional): The number of requested threads. Defaults to 152.</span>
<span class="sd">        number_of_gpus (int, optional): The number of GPUs requested on a node. Defaults to 4.</span>
<span class="sd">        chunk_size (int, optional): Number of simulations to submit in a chunk, should correspond to the number of requested GPUs. Defaults to 4.</span>
<span class="sd">        max_number_of_jobs (int, optional): Maximum number of job submissions allowed on the hpc. Defaults to None.</span>
<span class="sd">        max_runtime_hh_mm_ss (str, optional): Maximum runtime for a job. Defaults to &#39;24:00:00&#39;.</span>
<span class="sd">        conda_module (bool): Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</span>
<span class="sd">        chain_submission_number (int, optional): The number of job submissions that should be submitted as a sequential chain job. Defaults to 1.</span>
<span class="sd">        dependency_type (str, optional): Dependency keyword of the SLURM workload manager for chain jobs. Defaults to &#39;afternotok&#39;.</span>
<span class="sd">        checkpoint_frequency (int, optional): The frequency at which checkpoints are saved to restart from once a job continues. Defaults to 10000.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forcefields_</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^.*?/forcefield&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/forcefield&#39;</span><span class="p">,</span> <span class="n">forcefield</span><span class="p">)</span> <span class="k">for</span> <span class="n">forcefield</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcefields</span><span class="p">]</span>
    <span class="n">forcefields</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">forcefields_</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">max_number_of_jobs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">chunked_simulationsystems</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">chunked_simulationsystems</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)][:</span><span class="n">max_number_of_jobs</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunked_simulationsystems</span><span class="p">:</span>
        <span class="n">GPU_INDEX_COUNTER</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">m_utils</span><span class="o">.</span><span class="n">hpc_submission_header</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_adjust_to_correct_density.sh&#39;</span><span class="p">,</span> 
                                      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_adjust_to_correct_density&#39;</span><span class="p">,</span> 
                                      <span class="n">hpc_workspace</span><span class="p">,</span> 
                                      <span class="n">environment_name</span><span class="p">,</span>
                                      <span class="n">scheduler</span><span class="p">,</span>
                                      <span class="n">partition</span><span class="p">,</span>
                                      <span class="n">number_of_threads</span><span class="p">,</span>
                                      <span class="n">number_of_gpus</span><span class="p">,</span> 
                                      <span class="n">max_runtime_hh_mm_ss</span><span class="p">,</span>
                                      <span class="n">conda_module</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_adjust_to_correct_density.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;DeviceIndex&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Precision&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_properties</span><span class="p">:</span>
                    <span class="n">simulation_properties_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_properties</span>
                    <span class="n">simulation_properties_</span><span class="p">[</span><span class="s1">&#39;DeviceIndex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">GPU_INDEX_COUNTER</span><span class="si">}</span><span class="s1">&#39;</span>
                    <span class="n">simulation_properties</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="n">simulation_properties_</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">simulation_properties_</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;DeviceIndex&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">GPU_INDEX_COUNTER</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="s1">&#39;double&#39;</span><span class="p">}</span>
                    <span class="n">simulation_properties</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="n">simulation_properties_</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_platform</span> <span class="o">==</span> <span class="s1">&#39;CUDA&#39;</span><span class="p">:</span>
                    <span class="n">simulation_platform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_platform</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">simulation_platform</span> <span class="o">=</span> <span class="s1">&#39;CUDA&#39;</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_adjust_to_correct_density.py </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">simulation_properties</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">simulation_platform</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">forcefields</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">pme_error_tolerance</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">cutoff_distance_nm</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">cutoff_switch_distance_nm</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">pressure</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">simulationbox_name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">npt_equilibration_pressure_coupling_frequency</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">npt_equilibration_temperature_coupling_frequency</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">npt_equilibration_timestep_fs</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">npt_equilibration_steps</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">reporting_frequency_state_npt_equilibration</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">constraint_tolerance</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">checkpoint_frequency</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">elements</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">GPU_INDEX_COUNTER</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_adjust_to_correct_density.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">wait</span><span class="se">\n</span><span class="s1">exit 0&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/submit_adjust_to_correct_density.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunked_simulationsystems</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chain_submission_number</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;bash chainsubmitter.sh </span><span class="si">{</span><span class="n">chain_submission_number</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/shfiles/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_adjust_to_correct_density.sh </span><span class="si">{</span><span class="n">dependency_type</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">partition</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;sbatch chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_adjust_to_correct_density.sh</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.create_hpc_submission_analyze_density" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_hpc_submission_analyze_density</span><span class="p">(</span><span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span> <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span> <span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span> <span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;analysis&#39;</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span> <span class="n">partition</span><span class="o">=</span><span class="s1">&#39;cpuonly&#39;</span><span class="p">,</span> <span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span> <span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;00:10:00&#39;</span><span class="p">,</span> <span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.create_hpc_submission_analyze_density" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates job submission scripts for bwUniCluster 2.0 containing the density anlysis.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hpc_workspace</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the hpc workspace. Defaults to 'workspace'.</p></td>
          <td>
                <code>&#39;workspace&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hpc_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the project folder on the hpc. Defaults to 'workspace/project_name'.</p></td>
          <td>
                <code>&#39;workspace/project_name&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hpc_scripts_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the python scripts folder. Defaults to 'workspace/HPC'.</p></td>
          <td>
                <code>&#39;workspace/HPC&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>environment_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the anaconda environment containing the dependencies. Defaults to 'analysis'.</p></td>
          <td>
                <code>&#39;analysis&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scheduler</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The queue scheduler. Defaults to 'SBATCH'.</p></td>
          <td>
                <code>&#39;SBATCH&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>partition</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The partition the job should be submitted to. Defaults to 'cpuonly'.</p></td>
          <td>
                <code>&#39;cpuonly&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>number_of_threads</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of requested threads. Defaults to 152.</p></td>
          <td>
                <code>152</code>
          </td>
        </tr>
        <tr>
          <td><code>max_runtime_hh_mm_ss</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Maximum runtime for a job. Defaults to '00:10:00'.</p></td>
          <td>
                <code>&#39;00:10:00&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>conda_module</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_hpc_submission_analyze_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span>
<span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span>
<span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span>
<span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;analysis&#39;</span><span class="p">,</span>
<span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span>
<span class="n">partition</span><span class="o">=</span><span class="s1">&#39;cpuonly&#39;</span><span class="p">,</span>
<span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span>
<span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;00:10:00&#39;</span><span class="p">,</span>
<span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates job submission scripts for bwUniCluster 2.0 containing the density anlysis.</span>

<span class="sd">    Args:</span>
<span class="sd">        hpc_workspace (str, optional): The path to the hpc workspace. Defaults to &#39;workspace&#39;.</span>
<span class="sd">        hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">        hpc_scripts_folder (str, optional): The path to the python scripts folder. Defaults to &#39;workspace/HPC&#39;.</span>
<span class="sd">        environment_name (str, optional): The name of the anaconda environment containing the dependencies. Defaults to &#39;analysis&#39;.</span>
<span class="sd">        scheduler (str, optional): The queue scheduler. Defaults to &#39;SBATCH&#39;.</span>
<span class="sd">        partition (str, optional): The partition the job should be submitted to. Defaults to &#39;cpuonly&#39;.</span>
<span class="sd">        number_of_threads (int, optional): The number of requested threads. Defaults to 152.</span>
<span class="sd">        max_runtime_hh_mm_ss (str, optional): Maximum runtime for a job. Defaults to &#39;00:10:00&#39;.</span>
<span class="sd">        conda_module (bool): Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">description</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^.*?/project_description.json&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
    <span class="n">molecule_names</span><span class="p">,</span> <span class="n">chi_water_s</span><span class="p">,</span> <span class="n">temperature_s</span><span class="p">,</span> <span class="n">npt_equilibration_pressure_s</span><span class="p">,</span> <span class="n">name_list</span><span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecule_names</span><span class="p">,</span> 
                                                                                                                  <span class="bp">self</span><span class="o">.</span><span class="n">chi_water_s</span><span class="p">,</span> 
                                                                                                                  <span class="bp">self</span><span class="o">.</span><span class="n">temperature_s</span><span class="p">,</span> 
                                                                                                                  <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_pressure_s</span><span class="p">,</span>
                                                                                                                  <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">])</span>
    <span class="n">chunked_simulationsystems</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">10</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">),</span> <span class="mi">10</span><span class="p">)]</span>
    <span class="n">m_utils</span><span class="o">.</span><span class="n">hpc_submission_header</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/id</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_density.sh&#39;</span><span class="p">,</span> 
                                  <span class="sa">f</span><span class="s1">&#39;id</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_density&#39;</span><span class="p">,</span> 
                                  <span class="n">hpc_workspace</span><span class="p">,</span> 
                                  <span class="n">environment_name</span><span class="p">,</span>
                                  <span class="n">scheduler</span><span class="p">,</span>
                                  <span class="n">partition</span><span class="p">,</span>
                                  <span class="n">number_of_threads</span><span class="p">,</span>
                                  <span class="kc">None</span><span class="p">,</span>
                                  <span class="n">max_runtime_hh_mm_ss</span><span class="p">,</span>
                                  <span class="n">conda_module</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunked_simulationsystems</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/id</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_density.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_get_density.py </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">half_npt_equilibration_csv_columns</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">total_number_molecules</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">pressure</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">chi_water</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_names</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/id</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_density.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;wait</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/id</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_density.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_join_density.py </span><span class="si">{</span><span class="n">chi_water_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">temperature_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">npt_equilibration_pressure_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">name_list</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_names</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;wait</span><span class="se">\n</span><span class="s1">exit 0&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/submit_density_analysis.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">sbatch id</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_density.sh</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.create_hpc_submission_analyze_hbonds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_hpc_submission_analyze_hbonds</span><span class="p">(</span><span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span> <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span> <span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span> <span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;analysis&#39;</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span> <span class="n">partition</span><span class="o">=</span><span class="s1">&#39;cpuonly&#39;</span><span class="p">,</span> <span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span> <span class="n">parallel_running</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">submission_split</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;24:00:00&#39;</span><span class="p">,</span> <span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">donors</span><span class="o">=</span><span class="s1">&#39;donor_selection_string&#39;</span><span class="p">,</span> <span class="n">hydrogens</span><span class="o">=</span><span class="s1">&#39;hydrogen_selection_string&#39;</span><span class="p">,</span> <span class="n">acceptors</span><span class="o">=</span><span class="s1">&#39;acceptors_selection_string&#39;</span><span class="p">,</span> <span class="n">just_conclude</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.create_hpc_submission_analyze_hbonds" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates job submission scripts for bwUniCluster 2.0 or HoreKa containing the mean squared displacement, self-diffusion coefficient and viscosity analysis.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hpc_workspace</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the hpc workspace. Defaults to 'workspace'.</p></td>
          <td>
                <code>&#39;workspace&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hpc_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the project folder on the hpc. Defaults to 'workspace/project_name'.</p></td>
          <td>
                <code>&#39;workspace/project_name&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hpc_scripts_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the python scripts folder. Defaults to 'workspace/HPC'.</p></td>
          <td>
                <code>&#39;workspace/HPC&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>environment_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the anaconda environment containing the dependencies. Defaults to 'analysis'.</p></td>
          <td>
                <code>&#39;analysis&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scheduler</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The queue scheduler. Defaults to 'SBATCH'.</p></td>
          <td>
                <code>&#39;SBATCH&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>partition</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The partition the job should be submitted to. Defaults to 'cpuonly'.</p></td>
          <td>
                <code>&#39;cpuonly&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>number_of_threads</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of requested threads. Defaults to 152.</p></td>
          <td>
                <code>152</code>
          </td>
        </tr>
        <tr>
          <td><code>parallel_running</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of replica analyses running in parallel. Defaults to 5.</p></td>
          <td>
                <code>5</code>
          </td>
        </tr>
        <tr>
          <td><code>submission_split</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of job submissions the analysis is split in. Defaults to 4.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr>
          <td><code>max_runtime_hh_mm_ss</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Maximum runtime for a job. Defaults to '24:00:00'.</p></td>
          <td>
                <code>&#39;24:00:00&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>conda_module</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>donors</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Selection of all hydrogen bond donor atoms in MDAnalysis selection syntax. Defaults to 'donor_selection_string'.</p></td>
          <td>
                <code>&#39;donor_selection_string&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hydrogens</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Selection of all hydrogen bond hydrogen atoms in MDAnalysis selection syntax. Defaults to 'hydrogens_selection_string'.</p></td>
          <td>
                <code>&#39;hydrogen_selection_string&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>acceptors</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Selection of all hydrogen bond acceptor atoms in MDAnalysis selection syntax. Defaults to 'acceptors_selection_string'.</p></td>
          <td>
                <code>&#39;acceptors_selection_string&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>just_conclude</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If true, skips the generation of job submissions scripts and just generates the conclude script. Defaults to True.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_hpc_submission_analyze_hbonds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span>
<span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span>
<span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span>
<span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;analysis&#39;</span><span class="p">,</span>
<span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span>
<span class="n">partition</span><span class="o">=</span><span class="s1">&#39;cpuonly&#39;</span><span class="p">,</span>
<span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span>
<span class="n">parallel_running</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="n">submission_split</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;24:00:00&#39;</span><span class="p">,</span>
<span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="n">donors</span><span class="o">=</span><span class="s1">&#39;donor_selection_string&#39;</span><span class="p">,</span>
<span class="n">hydrogens</span><span class="o">=</span><span class="s1">&#39;hydrogen_selection_string&#39;</span><span class="p">,</span>
<span class="n">acceptors</span><span class="o">=</span><span class="s1">&#39;acceptors_selection_string&#39;</span><span class="p">,</span>
<span class="n">just_conclude</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates job submission scripts for bwUniCluster 2.0 or HoreKa containing the mean squared displacement, self-diffusion coefficient and viscosity analysis.</span>

<span class="sd">    Args:</span>
<span class="sd">        hpc_workspace (str, optional): The path to the hpc workspace. Defaults to &#39;workspace&#39;.</span>
<span class="sd">        hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">        hpc_scripts_folder (str, optional): The path to the python scripts folder. Defaults to &#39;workspace/HPC&#39;.</span>
<span class="sd">        environment_name (str, optional): The name of the anaconda environment containing the dependencies. Defaults to &#39;analysis&#39;.</span>
<span class="sd">        scheduler (str, optional): The queue scheduler. Defaults to &#39;SBATCH&#39;.</span>
<span class="sd">        partition (str, optional): The partition the job should be submitted to. Defaults to &#39;cpuonly&#39;.</span>
<span class="sd">        number_of_threads (int, optional): The number of requested threads. Defaults to 152.</span>
<span class="sd">        parallel_running (int, optional): The number of replica analyses running in parallel. Defaults to 5.</span>
<span class="sd">        submission_split (int, optional): The number of job submissions the analysis is split in. Defaults to 4.</span>
<span class="sd">        max_runtime_hh_mm_ss (str, optional): Maximum runtime for a job. Defaults to &#39;24:00:00&#39;.</span>
<span class="sd">        conda_module (bool): Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</span>
<span class="sd">        donors (str, optional): Selection of all hydrogen bond donor atoms in MDAnalysis selection syntax. Defaults to &#39;donor_selection_string&#39;.</span>
<span class="sd">        hydrogens (str, optional): Selection of all hydrogen bond hydrogen atoms in MDAnalysis selection syntax. Defaults to &#39;hydrogens_selection_string&#39;.</span>
<span class="sd">        acceptors (str, optional): Selection of all hydrogen bond acceptor atoms in MDAnalysis selection syntax. Defaults to &#39;acceptors_selection_string&#39;.</span>
<span class="sd">        just_conclude (bool, optional): If true, skips the generation of job submissions scripts and just generates the conclude script. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">description</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^.*?/project_description.json&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
    <span class="n">molecule_names</span><span class="p">,</span> <span class="n">number_dict</span><span class="p">,</span> <span class="n">chi_water_s</span><span class="p">,</span> <span class="n">temperature_s</span><span class="p">,</span> <span class="n">npt_equilibration_pressure_s</span><span class="p">,</span> <span class="n">molecule_abbreviations</span><span class="p">,</span> <span class="n">name_list</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecule_names</span><span class="p">,</span>
                                                                                                                                                                                            <span class="bp">self</span><span class="o">.</span><span class="n">replica_number_dict</span><span class="p">,</span>
                                                                                                                                                                                            <span class="bp">self</span><span class="o">.</span><span class="n">chi_water_s</span><span class="p">,</span>
                                                                                                                                                                                            <span class="bp">self</span><span class="o">.</span><span class="n">temperature_s</span><span class="p">,</span>
                                                                                                                                                                                            <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_pressure_s</span><span class="p">,</span>
                                                                                                                                                                                            <span class="bp">self</span><span class="o">.</span><span class="n">molecule_abbreviations</span><span class="p">,</span>
                                                                                                                                                                                            <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">])</span>
    <span class="n">chunked_replicas</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">parallel_running</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">),</span> <span class="n">parallel_running</span><span class="p">)]</span>
    <span class="n">split_fac</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">)</span> <span class="o">/</span> <span class="n">submission_split</span><span class="p">)</span>
    <span class="n">submission_splits</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunked_replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">split_fac</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">),</span> <span class="n">split_fac</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">submission_splits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">submission_split</span><span class="p">:</span>
        <span class="n">split_fac</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">)</span> <span class="o">/</span> <span class="n">submission_split</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">submission_splits</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunked_replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">split_fac</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">),</span> <span class="n">split_fac</span><span class="p">)]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">just_conclude</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">submission_splits</span><span class="p">:</span>
            <span class="n">m_utils</span><span class="o">.</span><span class="n">hpc_submission_header</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_hbonds.sh&#39;</span><span class="p">,</span> 
                                          <span class="sa">f</span><span class="s1">&#39;split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_hbonds&#39;</span><span class="p">,</span> 
                                          <span class="n">hpc_workspace</span><span class="p">,</span> 
                                          <span class="n">environment_name</span><span class="p">,</span>
                                          <span class="n">scheduler</span><span class="p">,</span>
                                          <span class="n">partition</span><span class="p">,</span>
                                          <span class="n">number_of_threads</span><span class="p">,</span>
                                          <span class="kc">None</span><span class="p">,</span>
                                          <span class="n">max_runtime_hh_mm_ss</span><span class="p">,</span>
                                          <span class="n">conda_module</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">split</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">:</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_hbonds.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_get_hbonds.py </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">replica_number</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">chi_water</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">pressure</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">total_number_molecules</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_names</span><span class="si">}</span><span class="s1"> &quot;</span><span class="si">{</span><span class="n">donors</span><span class="si">}</span><span class="s1">&quot; &quot;</span><span class="si">{</span><span class="n">hydrogens</span><span class="si">}</span><span class="s1">&quot; &quot;</span><span class="si">{</span><span class="n">acceptors</span><span class="si">}</span><span class="s1">&quot; &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_hbonds.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;wait</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_hbonds.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;exit 0&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/submit_hbonds_analysis.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">submission_splits</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;sbatch split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_hbonds.sh</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/conclude_hbonds.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;source </span><span class="si">{</span><span class="n">hpc_workspace</span><span class="si">}</span><span class="s1">/conda/etc/profile.d/conda.sh</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;conda activate </span><span class="si">{</span><span class="n">environment_name</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_join_hbonds.py </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">name_list</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">number_dict</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">chi_water_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">temperature_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">npt_equilibration_pressure_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_names</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_abbreviations</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_abbreviation</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">replica_start</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;wait</span><span class="se">\n</span><span class="s1">exit 0&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.create_hpc_submission_analyze_msd" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_hpc_submission_analyze_msd</span><span class="p">(</span><span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span> <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span> <span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span> <span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;analysis&#39;</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span> <span class="n">partition</span><span class="o">=</span><span class="s1">&#39;cpuonly&#39;</span><span class="p">,</span> <span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span> <span class="n">parallel_running</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">submission_split</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;24:00:00&#39;</span><span class="p">,</span> <span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fit_starting_percentage</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fit_ending_percentage</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">just_conclude</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.create_hpc_submission_analyze_msd" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates job submission scripts for bwUniCluster 2.0 or HoreKa containing the mean squared displacement, self-diffusion coefficient and viscosity analysis.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hpc_workspace</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the hpc workspace. Defaults to 'workspace'.</p></td>
          <td>
                <code>&#39;workspace&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hpc_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the project folder on the hpc. Defaults to 'workspace/project_name'.</p></td>
          <td>
                <code>&#39;workspace/project_name&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hpc_scripts_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the python scripts folder. Defaults to 'workspace/HPC'.</p></td>
          <td>
                <code>&#39;workspace/HPC&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>environment_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the anaconda environment containing the dependencies. Defaults to 'analysis'.</p></td>
          <td>
                <code>&#39;analysis&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scheduler</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The queue scheduler. Defaults to 'SBATCH'.</p></td>
          <td>
                <code>&#39;SBATCH&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>partition</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The partition the job should be submitted to. Defaults to 'cpuonly'.</p></td>
          <td>
                <code>&#39;cpuonly&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>number_of_threads</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of requested threads. Defaults to 152.</p></td>
          <td>
                <code>152</code>
          </td>
        </tr>
        <tr>
          <td><code>parallel_running</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of replica analyses running in parallel. Defaults to 5.</p></td>
          <td>
                <code>5</code>
          </td>
        </tr>
        <tr>
          <td><code>submission_split</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of job submissions the analysis is split in. Defaults to 4.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr>
          <td><code>max_runtime_hh_mm_ss</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Maximum runtime for a job. Defaults to '24:00:00'.</p></td>
          <td>
                <code>&#39;24:00:00&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>conda_module</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>fit_starting_percentage</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Start of the linear fit in percent of NVE production duration. Defaults to 20.</p></td>
          <td>
                <code>20</code>
          </td>
        </tr>
        <tr>
          <td><code>fit_ending_percentage</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Ending of the linear fit in percent of NVE production duration. Defaults to 80.</p></td>
          <td>
                <code>80</code>
          </td>
        </tr>
        <tr>
          <td><code>just_conclude</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If true, skips the generation of job submissions scripts and just generates the conclude script. Defaults to True.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_hpc_submission_analyze_msd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span>
<span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span>
<span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span>
<span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;analysis&#39;</span><span class="p">,</span>
<span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span>
<span class="n">partition</span><span class="o">=</span><span class="s1">&#39;cpuonly&#39;</span><span class="p">,</span>
<span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span>
<span class="n">parallel_running</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="n">submission_split</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;24:00:00&#39;</span><span class="p">,</span>
<span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="n">fit_starting_percentage</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="n">fit_ending_percentage</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
<span class="n">just_conclude</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates job submission scripts for bwUniCluster 2.0 or HoreKa containing the mean squared displacement, self-diffusion coefficient and viscosity analysis.</span>

<span class="sd">    Args:</span>
<span class="sd">        hpc_workspace (str, optional): The path to the hpc workspace. Defaults to &#39;workspace&#39;.</span>
<span class="sd">        hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">        hpc_scripts_folder (str, optional): The path to the python scripts folder. Defaults to &#39;workspace/HPC&#39;.</span>
<span class="sd">        environment_name (str, optional): The name of the anaconda environment containing the dependencies. Defaults to &#39;analysis&#39;.</span>
<span class="sd">        scheduler (str, optional): The queue scheduler. Defaults to &#39;SBATCH&#39;.</span>
<span class="sd">        partition (str, optional): The partition the job should be submitted to. Defaults to &#39;cpuonly&#39;.</span>
<span class="sd">        number_of_threads (int, optional): The number of requested threads. Defaults to 152.</span>
<span class="sd">        parallel_running (int, optional): The number of replica analyses running in parallel. Defaults to 5.</span>
<span class="sd">        submission_split (int, optional): The number of job submissions the analysis is split in. Defaults to 4.</span>
<span class="sd">        max_runtime_hh_mm_ss (str, optional): Maximum runtime for a job. Defaults to &#39;24:00:00&#39;.</span>
<span class="sd">        conda_module (bool): Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</span>
<span class="sd">        fit_starting_percentage (int, optional): Start of the linear fit in percent of NVE production duration. Defaults to 20.</span>
<span class="sd">        fit_ending_percentage (int, optional): Ending of the linear fit in percent of NVE production duration. Defaults to 80.</span>
<span class="sd">        just_conclude (bool, optional): If true, skips the generation of job submissions scripts and just generates the conclude script. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">description</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^.*?/project_description.json&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/project_description.json&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
    <span class="n">fit_starting_frame</span><span class="p">,</span> <span class="n">fit_ending_frame</span><span class="p">,</span> <span class="n">time_between_frames</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">msd_opt_prepper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nve_production_timestep_fs</span><span class="p">,</span>
                                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">nve_production_duration_ns</span><span class="p">,</span>
                                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">reporting_frequency_coordinates_unwrapped</span><span class="p">,</span>
                                                                                        <span class="n">fit_starting_percentage</span><span class="p">,</span>
                                                                                        <span class="n">fit_ending_percentage</span><span class="p">)</span>
    <span class="n">molecule_names</span><span class="p">,</span> <span class="n">molecule_abbreviations</span><span class="p">,</span> <span class="n">number_dict</span><span class="p">,</span> <span class="n">total_number_molecules</span><span class="p">,</span> <span class="n">chi_water_s</span><span class="p">,</span> <span class="n">temperature_s</span><span class="p">,</span> <span class="n">npt_equilibration_pressure_s</span><span class="p">,</span> <span class="n">name_list</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecule_names</span><span class="p">,</span>
                                                                                                                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">molecule_abbreviations</span><span class="p">,</span>
                                                                                                                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">replica_number_dict</span><span class="p">,</span>
                                                                                                                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">total_number_molecules</span><span class="p">,</span>
                                                                                                                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">chi_water_s</span><span class="p">,</span>
                                                                                                                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">temperature_s</span><span class="p">,</span>
                                                                                                                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_pressure_s</span><span class="p">,</span>
                                                                                                                                                                                <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">])</span>
    <span class="n">chunked_replicas</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">parallel_running</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">),</span> <span class="n">parallel_running</span><span class="p">)]</span>
    <span class="n">split_fac</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">)</span> <span class="o">/</span> <span class="n">submission_split</span><span class="p">)</span>
    <span class="n">submission_splits</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunked_replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">split_fac</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">),</span> <span class="n">split_fac</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">submission_splits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">submission_split</span><span class="p">:</span>
        <span class="n">split_fac</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">)</span> <span class="o">/</span> <span class="n">submission_split</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">submission_splits</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunked_replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">split_fac</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunked_replicas</span><span class="p">),</span> <span class="n">split_fac</span><span class="p">)]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">just_conclude</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">submission_splits</span><span class="p">:</span>
            <span class="n">m_utils</span><span class="o">.</span><span class="n">hpc_submission_header</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_msd.sh&#39;</span><span class="p">,</span> 
                                          <span class="sa">f</span><span class="s1">&#39;split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_msd&#39;</span><span class="p">,</span> 
                                          <span class="n">hpc_workspace</span><span class="p">,</span> 
                                          <span class="n">environment_name</span><span class="p">,</span>
                                          <span class="n">scheduler</span><span class="p">,</span>
                                          <span class="n">partition</span><span class="p">,</span>
                                          <span class="n">number_of_threads</span><span class="p">,</span>
                                          <span class="kc">None</span><span class="p">,</span>
                                          <span class="n">max_runtime_hh_mm_ss</span><span class="p">,</span>
                                          <span class="n">conda_module</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">split</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">:</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_msd.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_get_sdc.py </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">replica_number</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">chi_water</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_abbreviation</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_abbreviations</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">time_between_frames</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">fit_starting_frame</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">fit_ending_frame</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">pressure</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">total_number_molecules</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_names</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_name</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_msd.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;wait</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_msd.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;exit 0&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/submit_msd_analysis.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">submission_splits</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;sbatch split</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="si">}</span><span class="s1">_analyze_msd.sh</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/conclude_msd.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;source </span><span class="si">{</span><span class="n">hpc_workspace</span><span class="si">}</span><span class="s1">/conda/etc/profile.d/conda.sh</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;conda activate </span><span class="si">{</span><span class="n">environment_name</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_join_sdc_and_comp_visc.py </span><span class="si">{</span><span class="n">total_number_molecules</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">chi_water_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">temperature_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">npt_equilibration_pressure_s</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">name_list</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_names</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">number_dict</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">molecule_abbreviations</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">water_abbreviation</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">replica_start</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;wait</span><span class="se">\n</span><span class="s1">exit 0&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.create_hpc_submission_simulate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_hpc_submission_simulate</span><span class="p">(</span><span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span> <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span> <span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span> <span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;openmm_new&#39;</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span> <span class="n">partition</span><span class="o">=</span><span class="s1">&#39;accelerated&#39;</span><span class="p">,</span> <span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span> <span class="n">number_of_gpus</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_number_of_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;24:00:00&#39;</span><span class="p">,</span> <span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chain_submission_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dependency_type</span><span class="o">=</span><span class="s1">&#39;afternotok&#39;</span><span class="p">,</span> <span class="n">checkpoint_frequency</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.create_hpc_submission_simulate" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates job submission scripts for bwUniCluster 2.0 containing the NVT equilibration and NVE production.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hpc_workspace</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the hpc workspace. Defaults to 'workspace'.</p></td>
          <td>
                <code>&#39;workspace&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hpc_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the project folder on the hpc. Defaults to 'workspace/project_name'.</p></td>
          <td>
                <code>&#39;workspace/project_name&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hpc_scripts_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the python scripts folder. Defaults to 'workspace/HPC'.</p></td>
          <td>
                <code>&#39;workspace/HPC&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>environment_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the anaconda environment containing the dependencies. Defaults to 'openmmfin'.</p></td>
          <td>
                <code>&#39;openmm_new&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scheduler</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The queue scheduler. Defaults to 'SBATCH'.</p></td>
          <td>
                <code>&#39;SBATCH&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>partition</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The partition the job should be submitted to. Defaults to 'accelerated'.</p></td>
          <td>
                <code>&#39;accelerated&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>number_of_threads</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of requested threads. Defaults to 152.</p></td>
          <td>
                <code>152</code>
          </td>
        </tr>
        <tr>
          <td><code>number_of_gpus</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of GPUs requested on a node. Defaults to 4.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr>
          <td><code>chunk_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of simulations to submit in a chunk, should correspond to the number of requested GPUs. Defaults to 4.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr>
          <td><code>max_number_of_jobs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Maximum number of job submissions allowed on the hpc. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>max_runtime_hh_mm_ss</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Maximum runtime for a job. Defaults to '24:00:00'.</p></td>
          <td>
                <code>&#39;24:00:00&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>conda_module</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>chain_submission_number</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of job submissions that should be submitted as a sequential chain job. Defaults to 1.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>dependency_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Dependency keyword of the SLURM workload manager for chain jobs. Defaults to 'afternotok'.</p></td>
          <td>
                <code>&#39;afternotok&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>checkpoint_frequency</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The frequency at which checkpoints are saved to restart from once a job continues. Defaults to 10000.</p></td>
          <td>
                <code>10000</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_hpc_submission_simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span>
<span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span>
<span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span>
<span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;openmm_new&#39;</span><span class="p">,</span>
<span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;SBATCH&#39;</span><span class="p">,</span>
<span class="n">partition</span><span class="o">=</span><span class="s1">&#39;accelerated&#39;</span><span class="p">,</span>
<span class="n">number_of_threads</span><span class="o">=</span><span class="mi">152</span><span class="p">,</span>
<span class="n">number_of_gpus</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="n">chunk_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="n">max_number_of_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="n">max_runtime_hh_mm_ss</span><span class="o">=</span><span class="s1">&#39;24:00:00&#39;</span><span class="p">,</span>
<span class="n">conda_module</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="n">chain_submission_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="n">dependency_type</span><span class="o">=</span><span class="s1">&#39;afternotok&#39;</span><span class="p">,</span>
<span class="n">checkpoint_frequency</span><span class="o">=</span><span class="mi">10000</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates job submission scripts for bwUniCluster 2.0 containing the NVT equilibration and NVE production.</span>

<span class="sd">    Args:</span>
<span class="sd">        hpc_workspace (str, optional): The path to the hpc workspace. Defaults to &#39;workspace&#39;.</span>
<span class="sd">        hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">        hpc_scripts_folder (str, optional): The path to the python scripts folder. Defaults to &#39;workspace/HPC&#39;.</span>
<span class="sd">        environment_name (str, optional): The name of the anaconda environment containing the dependencies. Defaults to &#39;openmmfin&#39;.</span>
<span class="sd">        scheduler (str, optional): The queue scheduler. Defaults to &#39;SBATCH&#39;.</span>
<span class="sd">        partition (str, optional): The partition the job should be submitted to. Defaults to &#39;accelerated&#39;.</span>
<span class="sd">        number_of_threads (int, optional): The number of requested threads. Defaults to 152.</span>
<span class="sd">        number_of_gpus (int, optional): The number of GPUs requested on a node. Defaults to 4.</span>
<span class="sd">        chunk_size (int, optional): Number of simulations to submit in a chunk, should correspond to the number of requested GPUs. Defaults to 4.</span>
<span class="sd">        max_number_of_jobs (int, optional): Maximum number of job submissions allowed on the hpc. Defaults to None.</span>
<span class="sd">        max_runtime_hh_mm_ss (str, optional): Maximum runtime for a job. Defaults to &#39;24:00:00&#39;.</span>
<span class="sd">        conda_module (bool): Adapts the header to whether there is a conda module available on the hpc or not. Defaults to False.</span>
<span class="sd">        chain_submission_number (int, optional): The number of job submissions that should be submitted as a sequential chain job. Defaults to 1.</span>
<span class="sd">        dependency_type (str, optional): Dependency keyword of the SLURM workload manager for chain jobs. Defaults to &#39;afternotok&#39;.</span>
<span class="sd">        checkpoint_frequency (int, optional): The frequency at which checkpoints are saved to restart from once a job continues. Defaults to 10000.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forcefields_</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^.*?/forcefield&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/forcefield&#39;</span><span class="p">,</span> <span class="n">forcefield</span><span class="p">)</span> <span class="k">for</span> <span class="n">forcefield</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcefields</span><span class="p">]</span>
    <span class="n">forcefields</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">forcefields_</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">max_number_of_jobs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">chunked_replicas</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">chunked_replicas</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)][:</span><span class="n">max_number_of_jobs</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunked_replicas</span><span class="p">:</span>
        <span class="n">GPU_INDEX_COUNTER</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">m_utils</span><span class="o">.</span><span class="n">hpc_submission_header</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_simulate.sh&#39;</span><span class="p">,</span> 
                                      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_simulate&#39;</span><span class="p">,</span> 
                                      <span class="n">hpc_workspace</span><span class="p">,</span> 
                                      <span class="n">environment_name</span><span class="p">,</span>
                                      <span class="n">scheduler</span><span class="p">,</span>
                                      <span class="n">partition</span><span class="p">,</span>
                                      <span class="n">number_of_threads</span><span class="p">,</span>
                                      <span class="n">number_of_gpus</span><span class="p">,</span>
                                      <span class="n">max_runtime_hh_mm_ss</span><span class="p">,</span>
                                      <span class="n">conda_module</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_simulate.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;DeviceIndex&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Precision&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_properties</span><span class="p">:</span>
                    <span class="n">simulation_properties_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_properties</span>
                    <span class="n">simulation_properties_</span><span class="p">[</span><span class="s1">&#39;DeviceIndex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">GPU_INDEX_COUNTER</span><span class="si">}</span><span class="s1">&#39;</span>
                    <span class="n">simulation_properties</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="n">simulation_properties_</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">simulation_properties_</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;DeviceIndex&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">GPU_INDEX_COUNTER</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="s1">&#39;double&#39;</span><span class="p">}</span>
                    <span class="n">simulation_properties</span> <span class="o">=</span> <span class="n">m_utils</span><span class="o">.</span><span class="n">bash_arg_prepper</span><span class="p">(</span><span class="n">simulation_properties_</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_platform</span> <span class="o">==</span> <span class="s1">&#39;CUDA&#39;</span><span class="p">:</span>
                    <span class="n">simulation_platform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_platform</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">simulation_platform</span> <span class="o">=</span> <span class="s1">&#39;CUDA&#39;</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/cluster_simulate.py </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">simulation_properties</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">simulation_platform</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">forcefields</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">pme_error_tolerance</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">cutoff_distance_nm</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">cutoff_switch_distance_nm</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">replica_number</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">half_npt_equilibration_csv_columns</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">nvt_equilibration_temperature_coupling_frequency</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">nvt_equilibration_steps</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">nvt_equilibration_timestep_fs</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">reporting_frequency_state_nvt_equilibration</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">nve_production_timestep_fs</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">nve_production_steps</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">reporting_frequency_coordinates_unwrapped</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">reporting_frequency_coordinates_wrapped</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">reporting_frequency_state_nve_production</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">checkpoint_frequency</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">constraint_tolerance</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">elements</span><span class="si">}</span><span class="s1"> &amp;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">GPU_INDEX_COUNTER</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_simulate.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">wait</span><span class="se">\n</span><span class="s1">exit 0&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/submit_simulate.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunked_replicas</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chain_submission_number</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;bash chainsubmitter.sh </span><span class="si">{</span><span class="n">chain_submission_number</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/shfiles/chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_simulate.sh </span><span class="si">{</span><span class="n">dependency_type</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">partition</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;sbatch chunk</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="si">}</span><span class="s1">_simulate.sh</span><span class="se">\n</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.create_replicas" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_replicas</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.create_replicas" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates replicas of the systems and assigns NVT equilibration and NVE production parameters to them.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>start</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number from which on the replica numbering will start. Defaults to 1.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_replicas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates replicas of the systems and assigns NVT equilibration and NVE production parameters to them.</span>

<span class="sd">    Args:</span>
<span class="sd">        start (int, optional): The number from which on the replica numbering will start. Defaults to 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">replica_start</span> <span class="o">=</span> <span class="n">start</span>
    <span class="n">replica_count</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replica_count</span> <span class="o">+</span> <span class="n">start</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replica_number_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">tot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_number_molecules</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replica_number_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">tot</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">replica_count</span>
    <span class="n">parameter_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">,</span> <span class="n">replica_count</span><span class="p">]</span>
    <span class="n">combination_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">parameter_list</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">combination_list</span><span class="p">:</span>
        <span class="n">system</span><span class="p">,</span> <span class="n">replica_number</span> <span class="o">=</span> <span class="n">combination</span>
        <span class="n">replica</span> <span class="o">=</span> <span class="n">Replica</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">replica_number</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replica</span><span class="p">)</span>

    <span class="n">m_utils</span><span class="o">.</span><span class="n">add_json_entry</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;project&#39;</span><span class="p">,</span> <span class="n">subkey</span><span class="o">=</span><span class="s1">&#39;simulation_parameters&#39;</span><span class="p">,</span> <span class="n">subsubkey</span><span class="o">=</span><span class="s1">&#39;replica_starting_number&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.create_simulationboxes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_simulationboxes</span><span class="p">()</span></code>

<a href="#mixturemm.mixturemm.Project.create_simulationboxes" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates and packs the simulation boxes.</p>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_simulationboxes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates and packs the simulation boxes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">LINKER</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>

    <span class="k">for</span> <span class="n">total_number_molecules</span><span class="p">,</span> <span class="n">init_box_side_length</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_number_molecules</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_box_side_length</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">chi_water</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi_water_s</span><span class="p">:</span>
            <span class="n">string_total_number_molecules</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">total_number_molecules</span><span class="p">)</span>
            <span class="n">string_init_box_side_length</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">init_box_side_length</span><span class="p">)</span>
            <span class="n">string_chi_water</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">chi_water</span><span class="p">)</span>
            <span class="n">mixture_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="n">string_total_number_molecules</span><span class="p">,</span> <span class="n">string_init_box_side_length</span><span class="p">,</span> <span class="n">string_chi_water</span><span class="p">)</span>
            <span class="n">mixture_name</span> <span class="o">=</span> <span class="n">LINKER</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mixture_tuple</span><span class="p">)</span>
            <span class="n">simulation_box</span> <span class="o">=</span> <span class="n">Simulationbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total_number_molecules</span><span class="p">,</span> <span class="n">init_box_side_length</span><span class="p">,</span> <span class="n">chi_water</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_name</span><span class="p">,</span> <span class="n">mixture_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">simulation_boxes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simulation_box</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation_boxes</span><span class="p">:</span>
        <span class="n">x</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="n">x</span><span class="o">.</span><span class="n">conect_creator</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.create_systems" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_systems</span><span class="p">()</span></code>

<a href="#mixturemm.mixturemm.Project.create_systems" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Assigns temperature, pressure and NpT equilibration parameters to the boxes.</p>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_systems</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Assigns temperature, pressure and NpT equilibration parameters to the boxes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">parameter_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation_boxes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_pressure_s</span><span class="p">]</span>
    <span class="n">combination_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">parameter_list</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">combination_list</span><span class="p">:</span>
        <span class="n">simulationbox</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="n">combination</span>
        <span class="n">system</span> <span class="o">=</span> <span class="n">Simulationsystem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simulationbox</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">pressure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.hpc_extend_replica_folders" class="doc doc-heading">
<code class="highlight language-python"><span class="n">hpc_extend_replica_folders</span><span class="p">(</span><span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.hpc_extend_replica_folders" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates newly added replica folders to the system folders on the hpc.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hpc_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the project folder on the hpc. Defaults to 'workspace/project_name'.</p></td>
          <td>
                <code>&#39;workspace/project_name&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span></pre></div></td><td class="code"><div><pre><span></span><code>    <span class="k">def</span> <span class="nf">hpc_extend_replica_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Creates newly added replica folders to the system folders on the hpc.</span>

<span class="sd">        Args:</span>
<span class="sd">            hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">folder_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">:</span>
            <span class="n">folder_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">replica</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/extend_replica_folders.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">folder_string</span> <span class="ow">in</span> <span class="n">folder_list</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;mkdir </span><span class="si">{</span><span class="n">folder_string</span><span class="si">}</span><span class="s1"></span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.hpc_job_checker" class="doc doc-heading">
<code class="highlight language-python"><span class="n">hpc_job_checker</span><span class="p">(</span><span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span> <span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span> <span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span> <span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;openmm_new&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">energy_shift_tolerance_percent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.hpc_job_checker" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a bash script to check the overall status of the simulations on the hpc. Checked properties are doneness percent, average temperature and total energy shift.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hpc_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the project folder on the hpc. Defaults to 'workspace/project_name'.</p></td>
          <td>
                <code>&#39;workspace/project_name&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hpc_scripts_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the python scripts folder. Defaults to 'workspace/HPC'.</p></td>
          <td>
                <code>&#39;workspace/HPC&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hpc_workspace</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the hpc workspace. Defaults to 'workspace'.</p></td>
          <td>
                <code>&#39;workspace&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>environment_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the anaconda environment containing the dependencies. Defaults to 'openmm_new'.</p></td>
          <td>
                <code>&#39;openmm_new&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If true checks average temperature and total energy shift. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>energy_shift_tolerance_percent</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The tolerated energy shift in percent. If the energy shift of a simulation is greater, a warning is issued. Defaults to 1.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span></pre></div></td><td class="code"><div><pre><span></span><code>    <span class="k">def</span> <span class="nf">hpc_job_checker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
    <span class="n">hpc_folder</span><span class="o">=</span><span class="s1">&#39;workspace/project_name&#39;</span><span class="p">,</span> 
    <span class="n">hpc_scripts_folder</span><span class="o">=</span><span class="s1">&#39;workspace/HPC&#39;</span><span class="p">,</span> 
    <span class="n">hpc_workspace</span><span class="o">=</span><span class="s1">&#39;workspace&#39;</span><span class="p">,</span> 
    <span class="n">environment_name</span><span class="o">=</span><span class="s1">&#39;openmm_new&#39;</span><span class="p">,</span> 
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">energy_shift_tolerance_percent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Creates a bash script to check the overall status of the simulations on the hpc. Checked properties are doneness percent, average temperature and total energy shift.</span>

<span class="sd">        Args:</span>
<span class="sd">            hpc_folder (str, optional): The path to the project folder on the hpc. Defaults to &#39;workspace/project_name&#39;.</span>
<span class="sd">            hpc_scripts_folder (str, optional): The path to the python scripts folder. Defaults to &#39;workspace/HPC&#39;.</span>
<span class="sd">            hpc_workspace (str, optional): The path to the hpc workspace. Defaults to &#39;workspace&#39;.</span>
<span class="sd">            environment_name (str, optional): The name of the anaconda environment containing the dependencies. Defaults to &#39;openmm_new&#39;.</span>
<span class="sd">            verbose (bool, optional): If true checks average temperature and total energy shift. Defaults to True.</span>
<span class="sd">            energy_shift_tolerance_percent (int, optional): The tolerated energy shift in percent. If the energy shift of a simulation is greater, a warning is issued. Defaults to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">system_file_list_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">:</span>
            <span class="n">system_file_list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
        <span class="n">system_file_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">system_file_list_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">4</span><span class="p">])))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/system_list.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">file_str</span> <span class="ow">in</span> <span class="n">system_file_list</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;</span><span class="si">{</span><span class="n">file_str</span><span class="si">}</span><span class="s1"></span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">replica_file_list_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">:</span>
            <span class="n">replica_file_list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">replica</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
        <span class="n">replica_file_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">replica_file_list_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])))</span>
        <span class="n">replica_file_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;finalize&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/replica_list.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">file_str</span> <span class="ow">in</span> <span class="n">replica_file_list</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;</span><span class="si">{</span><span class="n">file_str</span><span class="si">}</span><span class="s1"></span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/job_checker.sh&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;#!/bin/bash</span>
<span class="s1">source </span><span class="si">{</span><span class="n">hpc_workspace</span><span class="si">}</span><span class="s1">/conda/etc/profile.d/conda.sh</span>
<span class="s1">conda activate </span><span class="si">{</span><span class="n">environment_name</span><span class="si">}</span><span class="s1"></span>
<span class="s1">python </span><span class="si">{</span><span class="n">hpc_scripts_folder</span><span class="si">}</span><span class="s1">/job_checker.py </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nvt_equilibration_duration_ns</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nve_production_duration_ns</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">verbose</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">energy_shift_tolerance_percent</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npt_equilibration_duration_ns</span><span class="si">}</span><span class="s1"></span>
<span class="s1">exit 0</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.overcharge_replicas" class="doc doc-heading">
<code class="highlight language-python"><span class="n">overcharge_replicas</span><span class="p">(</span><span class="n">total_number_molecules</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">overcharge_amount</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.overcharge_replicas" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Adds the overcharge amount to the replicas of the systems specified by total number of molecules.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>total_number_molecules</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of molecules that are placed in the simulation box. Defaults to 1000.</p></td>
          <td>
                <code>1000</code>
          </td>
        </tr>
        <tr>
          <td><code>overcharge_amount</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Amount of replicas that should be added. Defaults to 10.</p></td>
          <td>
                <code>10</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">overcharge_replicas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total_number_molecules</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">overcharge_amount</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Adds the overcharge amount to the replicas of the systems specified by total number of molecules.</span>

<span class="sd">    Args:</span>
<span class="sd">        total_number_molecules (int, optional): Number of molecules that are placed in the simulation box. Defaults to 1000.</span>
<span class="sd">        overcharge_amount (int, optional): Amount of replicas that should be added. Defaults to 10.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">filtered_systems</span> <span class="o">=</span> <span class="p">[</span><span class="n">system</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span> <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">total_number_molecules</span> <span class="ow">in</span> <span class="n">total_number_molecules</span><span class="p">]</span>
    <span class="n">replica_count</span> <span class="o">=</span> <span class="nb">range</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">replica_count</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">replica_start</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replica_count</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">replica_start</span> <span class="o">+</span> <span class="n">overcharge_amount</span><span class="p">))</span>
    <span class="n">parameter_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">filtered_systems</span><span class="p">,</span> <span class="n">replica_count</span><span class="p">]</span>
    <span class="n">combination_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">parameter_list</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">combination_list</span><span class="p">:</span>
        <span class="n">system</span><span class="p">,</span> <span class="n">replica_number</span> <span class="o">=</span> <span class="n">combination</span>
        <span class="n">replica</span> <span class="o">=</span> <span class="n">Replica</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">replica_number</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replica</span><span class="p">)</span>
    <span class="n">entry</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;with </span><span class="si">{</span><span class="n">overcharge_amount</span><span class="si">}</span><span class="s1"> replicas&#39;</span>
    <span class="n">m_utils</span><span class="o">.</span><span class="n">add_json_entry</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;project&#39;</span><span class="p">,</span> <span class="n">subkey</span><span class="o">=</span><span class="s1">&#39;simulation_parameters&#39;</span><span class="p">,</span> <span class="n">subsubkey</span><span class="o">=</span><span class="s1">&#39;overcharged_boxes&#39;</span><span class="p">,</span> <span class="n">subsubsubkey</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">total_number_molecules</span><span class="si">}</span><span class="s1"> molecules&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replica_number_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">total_number_molecules</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">replica_count</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">replica_start</span> <span class="o">+</span> <span class="n">overcharge_amount</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.remove_done_jobs_from_replicas" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_done_jobs_from_replicas</span><span class="p">(</span><span class="n">path_to_job_checks</span><span class="o">=</span><span class="s1">&#39;workdir/job_checks.txt&#39;</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.remove_done_jobs_from_replicas" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Removes all replicas that are done according to the job checker from the project.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path_to_job_checks</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the job checker output file. Defaults to 'workdir/job_checks.txt'.</p></td>
          <td>
                <code>&#39;workdir/job_checks.txt&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_done_jobs_from_replicas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_to_job_checks</span><span class="o">=</span><span class="s1">&#39;workdir/job_checks.txt&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Removes all replicas that are done according to the job checker from the project.</span>

<span class="sd">    Args:</span>
<span class="sd">        path_to_job_checks (str, optional): The path to the job checker output file. Defaults to &#39;workdir/job_checks.txt&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path_to_job_checks</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">not_done_job_list_</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">if</span> <span class="s1">&#39;not yet finished&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]</span>
        <span class="n">not_done_job_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[:</span><span class="o">-</span><span class="mi">17</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">not_done_job_list_</span><span class="p">]</span>
    <span class="n">filtered_replicas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">not_done_job_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">replica</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">string</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+$&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">())</span> <span class="o">==</span> <span class="n">replica</span><span class="o">.</span><span class="n">replica_number</span><span class="p">:</span>
                <span class="n">filtered_replicas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replica</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span> <span class="o">=</span> <span class="n">filtered_replicas</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.remove_done_jobs_from_systems" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_done_jobs_from_systems</span><span class="p">(</span><span class="n">path_to_job_checks</span><span class="o">=</span><span class="s1">&#39;workdir/job_checks.txt&#39;</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.remove_done_jobs_from_systems" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Removes all systems that are done according to the job checker from the project.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path_to_job_checks</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the job checker output file. Defaults to 'workdir/job_checks.txt'.</p></td>
          <td>
                <code>&#39;workdir/job_checks.txt&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_done_jobs_from_systems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_to_job_checks</span><span class="o">=</span><span class="s1">&#39;workdir/job_checks.txt&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Removes all systems that are done according to the job checker from the project.</span>

<span class="sd">    Args:</span>
<span class="sd">        path_to_job_checks (str, optional): The path to the job checker output file. Defaults to &#39;workdir/job_checks.txt&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path_to_job_checks</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">not_done_job_list_</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">if</span> <span class="s1">&#39;not yet adjusted&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]</span>
        <span class="n">not_done_job_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[:</span><span class="o">-</span><span class="mi">17</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">not_done_job_list_</span><span class="p">]</span>
    <span class="n">filtered_systems</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">not_done_job_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
                <span class="n">filtered_systems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span> <span class="o">=</span> <span class="n">filtered_systems</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.simulate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">simulate</span><span class="p">()</span></code>

<a href="#mixturemm.mixturemm.Project.simulate" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Runs the NVT equilibration and the NVE production.</p>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Runs the NVT equilibration and the NVE production.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">:</span>
        <span class="n">replica</span><span class="o">.</span><span class="n">nvt_equilibration</span><span class="p">()</span>
        <span class="n">replica</span><span class="o">.</span><span class="n">nve_production</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="mixturemm.mixturemm.Project.transfer_project" class="doc doc-heading">
<code class="highlight language-python"><span class="n">transfer_project</span><span class="p">(</span><span class="n">hpc_folder_old</span><span class="o">=</span><span class="s1">&#39;workspace_old/project_name&#39;</span><span class="p">,</span> <span class="n">hpc_folder_new</span><span class="o">=</span><span class="s1">&#39;workspace_new/project_name&#39;</span><span class="p">)</span></code>

<a href="#mixturemm.mixturemm.Project.transfer_project" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Transfers a project between two workspaces.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hpc_folder_old</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the old project folder on the hpc. Defaults to 'workspace_old/project_name'.</p></td>
          <td>
                <code>&#39;workspace_old/project_name&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hpc_folder_new</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path to the new project folder on the hpc. Defaults to 'workspace_new/project_name'.</p></td>
          <td>
                <code>&#39;workspace_new/project_name&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mixturemm/mixturemm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span></pre></div></td><td class="code"><div><pre><span></span><code>    <span class="k">def</span> <span class="nf">transfer_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">hpc_folder_old</span><span class="o">=</span><span class="s1">&#39;workspace_old/project_name&#39;</span><span class="p">,</span> 
    <span class="n">hpc_folder_new</span><span class="o">=</span><span class="s1">&#39;workspace_new/project_name&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Transfers a project between two workspaces.</span>

<span class="sd">        Args:</span>
<span class="sd">            hpc_folder_old (str, optional): The path to the old project folder on the hpc. Defaults to &#39;workspace_old/project_name&#39;.</span>
<span class="sd">            hpc_folder_new (str, optional): The path to the new project folder on the hpc. Defaults to &#39;workspace_new/project_name&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">system_file_list_old_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">system_file_list_new_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulationsystems</span><span class="p">:</span>
            <span class="n">system_file_list_old_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
            <span class="n">system_file_list_new_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">system</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
        <span class="n">system_file_list_old</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">system_file_list_old_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">4</span><span class="p">])))</span>
        <span class="n">system_file_list_new</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">system_file_list_new_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">4</span><span class="p">])))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/transfer_project.py&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;import shutil</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">file_str_old</span><span class="p">,</span> <span class="n">file_str_new</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">system_file_list_old</span><span class="p">,</span> <span class="n">system_file_list_new</span><span class="p">):</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">file_str_old</span><span class="si">}</span><span class="s1">/npt_equilibration&quot;, r&quot;</span><span class="si">{</span><span class="n">file_str_new</span><span class="si">}</span><span class="s1">/npt_equilibration&quot;)</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">replica_file_list_old_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">replica_file_list_new_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">replica</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">:</span>
            <span class="n">replica_file_list_old_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">replica</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
            <span class="n">replica_file_list_new_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;^.*?/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">replica</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">replica</span><span class="o">.</span><span class="n">folder</span><span class="p">))</span>
        <span class="n">replica_file_list_old</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">replica_file_list_old_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])))</span>
        <span class="n">replica_file_list_new</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">replica_file_list_new_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/transfer_project.py&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">file_str_old</span><span class="p">,</span> <span class="n">file_str_new</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">replica_file_list_old</span><span class="p">,</span> <span class="n">replica_file_list_new</span><span class="p">):</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">file_str_old</span><span class="si">}</span><span class="s1">&quot;, r&quot;</span><span class="si">{</span><span class="n">file_str_new</span><span class="si">}</span><span class="s1">&quot;)</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submitdir</span><span class="si">}</span><span class="s1">/transfer_project.py&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="sa">f</span><span class="s1">&#39;&#39;&#39;shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/boxes&quot;, r&quot;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/boxes&quot;)</span>
<span class="s1">shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/forcefield&quot;, r&quot;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/forcefield&quot;)</span>
<span class="s1">shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/hpc_submission&quot;, r&quot;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/hpc_submission&quot;)</span>
<span class="s1">shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/molecules&quot;, r&quot;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/molecules&quot;)</span>
<span class="s1">shutil.copytree(r&quot;</span><span class="si">{</span><span class="n">hpc_folder_old</span><span class="si">}</span><span class="s1">/results&quot;, r&quot;</span><span class="si">{</span><span class="n">hpc_folder_new</span><span class="si">}</span><span class="s1">/results&quot;)</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      2022-06-20
    
  </small>
</div>

              

            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
      
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../scientific/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Scientific background" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Scientific background
            </div>
          </div>
        </a>
      
      
        
        <a href="../background/" class="md-footer__link md-footer__link--next" aria-label="Next: background modue" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              background modue
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "search.highlight", "navigation.tabs", "navigation.top"], "search": "../assets/javascripts/workers/search.85cb4492.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.a877e258.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>